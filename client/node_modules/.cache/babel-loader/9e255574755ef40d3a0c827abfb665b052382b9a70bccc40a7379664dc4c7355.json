{"ast":null,"code":"/*!\n\npica\nhttps://github.com/nodeca/pica\n\n*/\n\n(function (f) {\n  if (typeof exports === \"object\" && typeof module !== \"undefined\") {\n    module.exports = f();\n  } else if (typeof define === \"function\" && define.amd) {\n    define([], f);\n  } else {\n    var g;\n    if (typeof window !== \"undefined\") {\n      g = window;\n    } else if (typeof global !== \"undefined\") {\n      g = global;\n    } else if (typeof self !== \"undefined\") {\n      g = self;\n    } else {\n      g = this;\n    }\n    g.pica = f();\n  }\n})(function () {\n  var define, module, exports;\n  return function () {\n    function r(e, n, t) {\n      function o(i, f) {\n        if (!n[i]) {\n          if (!e[i]) {\n            var c = \"function\" == typeof require && require;\n            if (!f && c) return c(i, !0);\n            if (u) return u(i, !0);\n            var a = new Error(\"Cannot find module '\" + i + \"'\");\n            throw a.code = \"MODULE_NOT_FOUND\", a;\n          }\n          var p = n[i] = {\n            exports: {}\n          };\n          e[i][0].call(p.exports, function (r) {\n            var n = e[i][1][r];\n            return o(n || r);\n          }, p, p.exports, r, e, n, t);\n        }\n        return n[i].exports;\n      }\n      for (var u = \"function\" == typeof require && require, i = 0; i < t.length; i++) o(t[i]);\n      return o;\n    }\n    return r;\n  }()({\n    1: [function (_dereq_, module, exports) {\n      // Collection of math functions\n      //\n      // 1. Combine components together\n      // 2. Has async init to load wasm modules\n      //\n      'use strict';\n\n      var Multimath = _dereq_('multimath');\n      var mm_unsharp_mask = _dereq_('./mm_unsharp_mask');\n      var mm_resize = _dereq_('./mm_resize');\n      function MathLib(requested_features) {\n        var __requested_features = requested_features || [];\n        var features = {\n          js: __requested_features.indexOf('js') >= 0,\n          wasm: __requested_features.indexOf('wasm') >= 0\n        };\n        Multimath.call(this, features);\n        this.features = {\n          js: features.js,\n          wasm: features.wasm && this.has_wasm()\n        };\n        this.use(mm_unsharp_mask);\n        this.use(mm_resize);\n      }\n      MathLib.prototype = Object.create(Multimath.prototype);\n      MathLib.prototype.constructor = MathLib;\n      MathLib.prototype.resizeAndUnsharp = function resizeAndUnsharp(options, cache) {\n        var result = this.resize(options, cache);\n        if (options.unsharpAmount) {\n          this.unsharp_mask(result, options.toWidth, options.toHeight, options.unsharpAmount, options.unsharpRadius, options.unsharpThreshold);\n        }\n        return result;\n      };\n      module.exports = MathLib;\n    }, {\n      \"./mm_resize\": 4,\n      \"./mm_unsharp_mask\": 9,\n      \"multimath\": 19\n    }],\n    2: [function (_dereq_, module, exports) {\n      // Resize convolvers, pure JS implementation\n      //\n      'use strict';\n\n      // Precision of fixed FP values\n      //var FIXED_FRAC_BITS = 14;\n      function clampTo8(i) {\n        return i < 0 ? 0 : i > 255 ? 255 : i;\n      }\n      function clampNegative(i) {\n        return i >= 0 ? i : 0;\n      } // Convolve image data in horizontal direction. Can be used for:\n      //\n      // 1. bitmap with premultiplied alpha\n      // 2. bitmap without alpha (all values 255)\n      //\n      // Notes:\n      //\n      // - output is transposed\n      // - output resolution is ~15 bits per channel(for better precision).\n      //\n\n      function convolveHor(src, dest, srcW, srcH, destW, filters) {\n        var r, g, b, a;\n        var filterPtr, filterShift, filterSize;\n        var srcPtr, srcY, destX, filterVal;\n        var srcOffset = 0,\n          destOffset = 0; // For each row\n\n        for (srcY = 0; srcY < srcH; srcY++) {\n          filterPtr = 0; // Apply precomputed filters to each destination row point\n\n          for (destX = 0; destX < destW; destX++) {\n            // Get the filter that determines the current output pixel.\n            filterShift = filters[filterPtr++];\n            filterSize = filters[filterPtr++];\n            srcPtr = srcOffset + filterShift * 4 | 0;\n            r = g = b = a = 0; // Apply the filter to the row to get the destination pixel r, g, b, a\n\n            for (; filterSize > 0; filterSize--) {\n              filterVal = filters[filterPtr++]; // Use reverse order to workaround deopts in old v8 (node v.10)\n              // Big thanks to @mraleph (Vyacheslav Egorov) for the tip.\n\n              a = a + filterVal * src[srcPtr + 3] | 0;\n              b = b + filterVal * src[srcPtr + 2] | 0;\n              g = g + filterVal * src[srcPtr + 1] | 0;\n              r = r + filterVal * src[srcPtr] | 0;\n              srcPtr = srcPtr + 4 | 0;\n            } // Store 15 bits between passes for better precision\n            // Instead of shift to 14 (FIXED_FRAC_BITS), shift to 7 only\n            //\n\n            dest[destOffset + 3] = clampNegative(a >> 7);\n            dest[destOffset + 2] = clampNegative(b >> 7);\n            dest[destOffset + 1] = clampNegative(g >> 7);\n            dest[destOffset] = clampNegative(r >> 7);\n            destOffset = destOffset + srcH * 4 | 0;\n          }\n          destOffset = (srcY + 1) * 4 | 0;\n          srcOffset = (srcY + 1) * srcW * 4 | 0;\n        }\n      } // Supplementary method for `convolveHor()`\n      //\n\n      function convolveVert(src, dest, srcW, srcH, destW, filters) {\n        var r, g, b, a;\n        var filterPtr, filterShift, filterSize;\n        var srcPtr, srcY, destX, filterVal;\n        var srcOffset = 0,\n          destOffset = 0; // For each row\n\n        for (srcY = 0; srcY < srcH; srcY++) {\n          filterPtr = 0; // Apply precomputed filters to each destination row point\n\n          for (destX = 0; destX < destW; destX++) {\n            // Get the filter that determines the current output pixel.\n            filterShift = filters[filterPtr++];\n            filterSize = filters[filterPtr++];\n            srcPtr = srcOffset + filterShift * 4 | 0;\n            r = g = b = a = 0; // Apply the filter to the row to get the destination pixel r, g, b, a\n\n            for (; filterSize > 0; filterSize--) {\n              filterVal = filters[filterPtr++]; // Use reverse order to workaround deopts in old v8 (node v.10)\n              // Big thanks to @mraleph (Vyacheslav Egorov) for the tip.\n\n              a = a + filterVal * src[srcPtr + 3] | 0;\n              b = b + filterVal * src[srcPtr + 2] | 0;\n              g = g + filterVal * src[srcPtr + 1] | 0;\n              r = r + filterVal * src[srcPtr] | 0;\n              srcPtr = srcPtr + 4 | 0;\n            } // Sync with premultiplied version for exact result match\n\n            r >>= 7;\n            g >>= 7;\n            b >>= 7;\n            a >>= 7; // Bring this value back in range + round result.\n            //\n\n            dest[destOffset + 3] = clampTo8(a + (1 << 13) >> 14);\n            dest[destOffset + 2] = clampTo8(b + (1 << 13) >> 14);\n            dest[destOffset + 1] = clampTo8(g + (1 << 13) >> 14);\n            dest[destOffset] = clampTo8(r + (1 << 13) >> 14);\n            destOffset = destOffset + srcH * 4 | 0;\n          }\n          destOffset = (srcY + 1) * 4 | 0;\n          srcOffset = (srcY + 1) * srcW * 4 | 0;\n        }\n      } // Premultiply & convolve image data in horizontal direction. Can be used for:\n      //\n      // - Any bitmap data, extracted with `.getImageData()` method (with\n      //   non-premultiplied alpha)\n      //\n      // For images without alpha channel this method is slower than `convolveHor()`\n      //\n\n      function convolveHorWithPre(src, dest, srcW, srcH, destW, filters) {\n        var r, g, b, a, alpha;\n        var filterPtr, filterShift, filterSize;\n        var srcPtr, srcY, destX, filterVal;\n        var srcOffset = 0,\n          destOffset = 0; // For each row\n\n        for (srcY = 0; srcY < srcH; srcY++) {\n          filterPtr = 0; // Apply precomputed filters to each destination row point\n\n          for (destX = 0; destX < destW; destX++) {\n            // Get the filter that determines the current output pixel.\n            filterShift = filters[filterPtr++];\n            filterSize = filters[filterPtr++];\n            srcPtr = srcOffset + filterShift * 4 | 0;\n            r = g = b = a = 0; // Apply the filter to the row to get the destination pixel r, g, b, a\n\n            for (; filterSize > 0; filterSize--) {\n              filterVal = filters[filterPtr++]; // Use reverse order to workaround deopts in old v8 (node v.10)\n              // Big thanks to @mraleph (Vyacheslav Egorov) for the tip.\n\n              alpha = src[srcPtr + 3];\n              a = a + filterVal * alpha | 0;\n              b = b + filterVal * src[srcPtr + 2] * alpha | 0;\n              g = g + filterVal * src[srcPtr + 1] * alpha | 0;\n              r = r + filterVal * src[srcPtr] * alpha | 0;\n              srcPtr = srcPtr + 4 | 0;\n            } // Premultiply is (* alpha / 255).\n            // Postpone division for better performance\n\n            b = b / 255 | 0;\n            g = g / 255 | 0;\n            r = r / 255 | 0; // Store 15 bits between passes for better precision\n            // Instead of shift to 14 (FIXED_FRAC_BITS), shift to 7 only\n            //\n\n            dest[destOffset + 3] = clampNegative(a >> 7);\n            dest[destOffset + 2] = clampNegative(b >> 7);\n            dest[destOffset + 1] = clampNegative(g >> 7);\n            dest[destOffset] = clampNegative(r >> 7);\n            destOffset = destOffset + srcH * 4 | 0;\n          }\n          destOffset = (srcY + 1) * 4 | 0;\n          srcOffset = (srcY + 1) * srcW * 4 | 0;\n        }\n      } // Supplementary method for `convolveHorWithPre()`\n      //\n\n      function convolveVertWithPre(src, dest, srcW, srcH, destW, filters) {\n        var r, g, b, a;\n        var filterPtr, filterShift, filterSize;\n        var srcPtr, srcY, destX, filterVal;\n        var srcOffset = 0,\n          destOffset = 0; // For each row\n\n        for (srcY = 0; srcY < srcH; srcY++) {\n          filterPtr = 0; // Apply precomputed filters to each destination row point\n\n          for (destX = 0; destX < destW; destX++) {\n            // Get the filter that determines the current output pixel.\n            filterShift = filters[filterPtr++];\n            filterSize = filters[filterPtr++];\n            srcPtr = srcOffset + filterShift * 4 | 0;\n            r = g = b = a = 0; // Apply the filter to the row to get the destination pixel r, g, b, a\n\n            for (; filterSize > 0; filterSize--) {\n              filterVal = filters[filterPtr++]; // Use reverse order to workaround deopts in old v8 (node v.10)\n              // Big thanks to @mraleph (Vyacheslav Egorov) for the tip.\n\n              a = a + filterVal * src[srcPtr + 3] | 0;\n              b = b + filterVal * src[srcPtr + 2] | 0;\n              g = g + filterVal * src[srcPtr + 1] | 0;\n              r = r + filterVal * src[srcPtr] | 0;\n              srcPtr = srcPtr + 4 | 0;\n            } // Downscale to leave room for un-premultiply\n\n            r >>= 7;\n            g >>= 7;\n            b >>= 7;\n            a >>= 7; // Un-premultiply\n\n            a = clampTo8(a + (1 << 13) >> 14);\n            if (a > 0) {\n              r = r * 255 / a | 0;\n              g = g * 255 / a | 0;\n              b = b * 255 / a | 0;\n            } // Bring this value back in range + round result.\n            // Shift value = FIXED_FRAC_BITS + 7\n            //\n\n            dest[destOffset + 3] = a;\n            dest[destOffset + 2] = clampTo8(b + (1 << 13) >> 14);\n            dest[destOffset + 1] = clampTo8(g + (1 << 13) >> 14);\n            dest[destOffset] = clampTo8(r + (1 << 13) >> 14);\n            destOffset = destOffset + srcH * 4 | 0;\n          }\n          destOffset = (srcY + 1) * 4 | 0;\n          srcOffset = (srcY + 1) * srcW * 4 | 0;\n        }\n      }\n      module.exports = {\n        convolveHor: convolveHor,\n        convolveVert: convolveVert,\n        convolveHorWithPre: convolveHorWithPre,\n        convolveVertWithPre: convolveVertWithPre\n      };\n    }, {}],\n    3: [function (_dereq_, module, exports) {\n      // This is autogenerated file from math.wasm, don't edit.\n      //\n      'use strict';\n\n      /* eslint-disable max-len */\n      module.exports = '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';\n    }, {}],\n    4: [function (_dereq_, module, exports) {\n      'use strict';\n\n      module.exports = {\n        name: 'resize',\n        fn: _dereq_('./resize'),\n        wasm_fn: _dereq_('./resize_wasm'),\n        wasm_src: _dereq_('./convolve_wasm_base64')\n      };\n    }, {\n      \"./convolve_wasm_base64\": 3,\n      \"./resize\": 5,\n      \"./resize_wasm\": 8\n    }],\n    5: [function (_dereq_, module, exports) {\n      'use strict';\n\n      var createFilters = _dereq_('./resize_filter_gen');\n      var _require = _dereq_('./convolve'),\n        convolveHor = _require.convolveHor,\n        convolveVert = _require.convolveVert,\n        convolveHorWithPre = _require.convolveHorWithPre,\n        convolveVertWithPre = _require.convolveVertWithPre;\n      function hasAlpha(src, width, height) {\n        var ptr = 3,\n          len = width * height * 4 | 0;\n        while (ptr < len) {\n          if (src[ptr] !== 255) return true;\n          ptr = ptr + 4 | 0;\n        }\n        return false;\n      }\n      function resetAlpha(dst, width, height) {\n        var ptr = 3,\n          len = width * height * 4 | 0;\n        while (ptr < len) {\n          dst[ptr] = 0xFF;\n          ptr = ptr + 4 | 0;\n        }\n      }\n      module.exports = function resize(options) {\n        var src = options.src;\n        var srcW = options.width;\n        var srcH = options.height;\n        var destW = options.toWidth;\n        var destH = options.toHeight;\n        var scaleX = options.scaleX || options.toWidth / options.width;\n        var scaleY = options.scaleY || options.toHeight / options.height;\n        var offsetX = options.offsetX || 0;\n        var offsetY = options.offsetY || 0;\n        var dest = options.dest || new Uint8Array(destW * destH * 4);\n        var filter = typeof options.filter === 'undefined' ? 'mks2013' : options.filter;\n        var filtersX = createFilters(filter, srcW, destW, scaleX, offsetX),\n          filtersY = createFilters(filter, srcH, destH, scaleY, offsetY);\n        var tmp = new Uint16Array(destW * srcH * 4); // Autodetect if alpha channel exists, and use appropriate method\n\n        if (hasAlpha(src, srcW, srcH)) {\n          convolveHorWithPre(src, tmp, srcW, srcH, destW, filtersX);\n          convolveVertWithPre(tmp, dest, srcH, destW, destH, filtersY);\n        } else {\n          convolveHor(src, tmp, srcW, srcH, destW, filtersX);\n          convolveVert(tmp, dest, srcH, destW, destH, filtersY);\n          resetAlpha(dest, destW, destH);\n        }\n        return dest;\n      };\n    }, {\n      \"./convolve\": 2,\n      \"./resize_filter_gen\": 6\n    }],\n    6: [function (_dereq_, module, exports) {\n      // Calculate convolution filters for each destination point,\n      // and pack data to Int16Array:\n      //\n      // [ shift, length, data..., shift2, length2, data..., ... ]\n      //\n      // - shift - offset in src image\n      // - length - filter length (in src points)\n      // - data - filter values sequence\n      //\n      'use strict';\n\n      var FILTER_INFO = _dereq_('./resize_filter_info'); // Precision of fixed FP values\n\n      var FIXED_FRAC_BITS = 14;\n      function toFixedPoint(num) {\n        return Math.round(num * ((1 << FIXED_FRAC_BITS) - 1));\n      }\n      module.exports = function resizeFilterGen(filter, srcSize, destSize, scale, offset) {\n        var filterFunction = FILTER_INFO.filter[filter].fn;\n        var scaleInverted = 1.0 / scale;\n        var scaleClamped = Math.min(1.0, scale); // For upscale\n        // Filter window (averaging interval), scaled to src image\n\n        var srcWindow = FILTER_INFO.filter[filter].win / scaleClamped;\n        var destPixel, srcPixel, srcFirst, srcLast, filterElementSize, floatFilter, fxpFilter, total, pxl, idx, floatVal, filterTotal, filterVal;\n        var leftNotEmpty, rightNotEmpty, filterShift, filterSize;\n        var maxFilterElementSize = Math.floor((srcWindow + 1) * 2);\n        var packedFilter = new Int16Array((maxFilterElementSize + 2) * destSize);\n        var packedFilterPtr = 0;\n        var slowCopy = !packedFilter.subarray || !packedFilter.set; // For each destination pixel calculate source range and built filter values\n\n        for (destPixel = 0; destPixel < destSize; destPixel++) {\n          // Scaling should be done relative to central pixel point\n          srcPixel = (destPixel + 0.5) * scaleInverted + offset;\n          srcFirst = Math.max(0, Math.floor(srcPixel - srcWindow));\n          srcLast = Math.min(srcSize - 1, Math.ceil(srcPixel + srcWindow));\n          filterElementSize = srcLast - srcFirst + 1;\n          floatFilter = new Float32Array(filterElementSize);\n          fxpFilter = new Int16Array(filterElementSize);\n          total = 0.0; // Fill filter values for calculated range\n\n          for (pxl = srcFirst, idx = 0; pxl <= srcLast; pxl++, idx++) {\n            floatVal = filterFunction((pxl + 0.5 - srcPixel) * scaleClamped);\n            total += floatVal;\n            floatFilter[idx] = floatVal;\n          } // Normalize filter, convert to fixed point and accumulate conversion error\n\n          filterTotal = 0;\n          for (idx = 0; idx < floatFilter.length; idx++) {\n            filterVal = floatFilter[idx] / total;\n            filterTotal += filterVal;\n            fxpFilter[idx] = toFixedPoint(filterVal);\n          } // Compensate normalization error, to minimize brightness drift\n\n          fxpFilter[destSize >> 1] += toFixedPoint(1.0 - filterTotal); //\n          // Now pack filter to useable form\n          //\n          // 1. Trim heading and tailing zero values, and compensate shitf/length\n          // 2. Put all to single array in this format:\n          //\n          //    [ pos shift, data length, value1, value2, value3, ... ]\n          //\n\n          leftNotEmpty = 0;\n          while (leftNotEmpty < fxpFilter.length && fxpFilter[leftNotEmpty] === 0) {\n            leftNotEmpty++;\n          }\n          if (leftNotEmpty < fxpFilter.length) {\n            rightNotEmpty = fxpFilter.length - 1;\n            while (rightNotEmpty > 0 && fxpFilter[rightNotEmpty] === 0) {\n              rightNotEmpty--;\n            }\n            filterShift = srcFirst + leftNotEmpty;\n            filterSize = rightNotEmpty - leftNotEmpty + 1;\n            packedFilter[packedFilterPtr++] = filterShift; // shift\n\n            packedFilter[packedFilterPtr++] = filterSize; // size\n\n            if (!slowCopy) {\n              packedFilter.set(fxpFilter.subarray(leftNotEmpty, rightNotEmpty + 1), packedFilterPtr);\n              packedFilterPtr += filterSize;\n            } else {\n              // fallback for old IE < 11, without subarray/set methods\n              for (idx = leftNotEmpty; idx <= rightNotEmpty; idx++) {\n                packedFilter[packedFilterPtr++] = fxpFilter[idx];\n              }\n            }\n          } else {\n            // zero data, write header only\n            packedFilter[packedFilterPtr++] = 0; // shift\n\n            packedFilter[packedFilterPtr++] = 0; // size\n          }\n        }\n\n        return packedFilter;\n      };\n    }, {\n      \"./resize_filter_info\": 7\n    }],\n    7: [function (_dereq_, module, exports) {\n      // Filter definitions to build tables for\n      // resizing convolvers.\n      //\n      // Presets for quality 0..3. Filter functions + window size\n      //\n      'use strict';\n\n      var filter = {\n        // Nearest neibor\n        box: {\n          win: 0.5,\n          fn: function fn(x) {\n            if (x < 0) x = -x;\n            return x < 0.5 ? 1.0 : 0.0;\n          }\n        },\n        // // Hamming\n        hamming: {\n          win: 1.0,\n          fn: function fn(x) {\n            if (x < 0) x = -x;\n            if (x >= 1.0) {\n              return 0.0;\n            }\n            if (x < 1.19209290E-07) {\n              return 1.0;\n            }\n            var xpi = x * Math.PI;\n            return Math.sin(xpi) / xpi * (0.54 + 0.46 * Math.cos(xpi / 1.0));\n          }\n        },\n        // Lanczos, win = 2\n        lanczos2: {\n          win: 2.0,\n          fn: function fn(x) {\n            if (x < 0) x = -x;\n            if (x >= 2.0) {\n              return 0.0;\n            }\n            if (x < 1.19209290E-07) {\n              return 1.0;\n            }\n            var xpi = x * Math.PI;\n            return Math.sin(xpi) / xpi * Math.sin(xpi / 2.0) / (xpi / 2.0);\n          }\n        },\n        // Lanczos, win = 3\n        lanczos3: {\n          win: 3.0,\n          fn: function fn(x) {\n            if (x < 0) x = -x;\n            if (x >= 3.0) {\n              return 0.0;\n            }\n            if (x < 1.19209290E-07) {\n              return 1.0;\n            }\n            var xpi = x * Math.PI;\n            return Math.sin(xpi) / xpi * Math.sin(xpi / 3.0) / (xpi / 3.0);\n          }\n        },\n        // Magic Kernel Sharp 2013, win = 2.5\n        // http://johncostella.com/magic/\n        mks2013: {\n          win: 2.5,\n          fn: function fn(x) {\n            if (x < 0) x = -x;\n            if (x >= 2.5) {\n              return 0.0;\n            }\n            if (x >= 1.5) {\n              return -0.125 * (x - 2.5) * (x - 2.5);\n            }\n            if (x >= 0.5) {\n              return 0.25 * (4 * x * x - 11 * x + 7);\n            }\n            return 1.0625 - 1.75 * x * x;\n          }\n        }\n      };\n      module.exports = {\n        filter: filter,\n        // Legacy mapping\n        f2q: {\n          box: 0,\n          hamming: 1,\n          lanczos2: 2,\n          lanczos3: 3\n        },\n        q2f: ['box', 'hamming', 'lanczos2', 'lanczos3']\n      };\n    }, {}],\n    8: [function (_dereq_, module, exports) {\n      'use strict';\n\n      var createFilters = _dereq_('./resize_filter_gen');\n      function hasAlpha(src, width, height) {\n        var ptr = 3,\n          len = width * height * 4 | 0;\n        while (ptr < len) {\n          if (src[ptr] !== 255) return true;\n          ptr = ptr + 4 | 0;\n        }\n        return false;\n      }\n      function resetAlpha(dst, width, height) {\n        var ptr = 3,\n          len = width * height * 4 | 0;\n        while (ptr < len) {\n          dst[ptr] = 0xFF;\n          ptr = ptr + 4 | 0;\n        }\n      }\n      function asUint8Array(src) {\n        return new Uint8Array(src.buffer, 0, src.byteLength);\n      }\n      var IS_LE = true; // should not crash everything on module load in old browsers\n\n      try {\n        IS_LE = new Uint32Array(new Uint8Array([1, 0, 0, 0]).buffer)[0] === 1;\n      } catch (__) {}\n      function copyInt16asLE(src, target, target_offset) {\n        if (IS_LE) {\n          target.set(asUint8Array(src), target_offset);\n          return;\n        }\n        for (var ptr = target_offset, i = 0; i < src.length; i++) {\n          var data = src[i];\n          target[ptr++] = data & 0xFF;\n          target[ptr++] = data >> 8 & 0xFF;\n        }\n      }\n      module.exports = function resize_wasm(options) {\n        var src = options.src;\n        var srcW = options.width;\n        var srcH = options.height;\n        var destW = options.toWidth;\n        var destH = options.toHeight;\n        var scaleX = options.scaleX || options.toWidth / options.width;\n        var scaleY = options.scaleY || options.toHeight / options.height;\n        var offsetX = options.offsetX || 0.0;\n        var offsetY = options.offsetY || 0.0;\n        var dest = options.dest || new Uint8Array(destW * destH * 4);\n        var filter = typeof options.filter === 'undefined' ? 'mks2013' : options.filter;\n        var filtersX = createFilters(filter, srcW, destW, scaleX, offsetX),\n          filtersY = createFilters(filter, srcH, destH, scaleY, offsetY); // destination is 0 too.\n\n        var src_offset = 0;\n        var src_size = Math.max(src.byteLength, dest.byteLength); // buffer between convolve passes\n\n        var tmp_offset = this.__align(src_offset + src_size);\n        var tmp_size = srcH * destW * 4 * 2; // 2 bytes per channel\n\n        var filtersX_offset = this.__align(tmp_offset + tmp_size);\n        var filtersY_offset = this.__align(filtersX_offset + filtersX.byteLength);\n        var alloc_bytes = filtersY_offset + filtersY.byteLength;\n        var instance = this.__instance('resize', alloc_bytes); //\n        // Fill memory block with data to process\n        //\n\n        var mem = new Uint8Array(this.__memory.buffer);\n        var mem32 = new Uint32Array(this.__memory.buffer); // 32-bit copy is much faster in chrome\n\n        var src32 = new Uint32Array(src.buffer);\n        mem32.set(src32); // We should guarantee LE bytes order. Filters are not big, so\n        // speed difference is not significant vs direct .set()\n\n        copyInt16asLE(filtersX, mem, filtersX_offset);\n        copyInt16asLE(filtersY, mem, filtersY_offset); // Now call webassembly method\n        // emsdk does method names with '_'\n\n        var fn = instance.exports.convolveHV || instance.exports._convolveHV;\n        if (hasAlpha(src, srcW, srcH)) {\n          fn(filtersX_offset, filtersY_offset, tmp_offset, srcW, srcH, destW, destH, 1);\n        } else {\n          fn(filtersX_offset, filtersY_offset, tmp_offset, srcW, srcH, destW, destH, 0);\n          resetAlpha(dest, destW, destH);\n        } //\n        // Copy data back to typed array\n        //\n        // 32-bit copy is much faster in chrome\n\n        var dest32 = new Uint32Array(dest.buffer);\n        dest32.set(new Uint32Array(this.__memory.buffer, 0, destH * destW));\n        return dest;\n      };\n    }, {\n      \"./resize_filter_gen\": 6\n    }],\n    9: [function (_dereq_, module, exports) {\n      'use strict';\n\n      module.exports = {\n        name: 'unsharp_mask',\n        fn: _dereq_('./unsharp_mask'),\n        wasm_fn: _dereq_('./unsharp_mask_wasm'),\n        wasm_src: _dereq_('./unsharp_mask_wasm_base64')\n      };\n    }, {\n      \"./unsharp_mask\": 10,\n      \"./unsharp_mask_wasm\": 11,\n      \"./unsharp_mask_wasm_base64\": 12\n    }],\n    10: [function (_dereq_, module, exports) {\n      // Unsharp mask filter\n      //\n      // http://stackoverflow.com/a/23322820/1031804\n      // USM(O) = O + (2 * (Amount / 100) * (O - GB))\n      // GB - gaussian blur.\n      //\n      // Image is converted from RGB to HSV, unsharp mask is applied to the\n      // brightness channel and then image is converted back to RGB.\n      //\n      'use strict';\n\n      var glur_mono16 = _dereq_('glur/mono16');\n      function hsv_v16(img, width, height) {\n        var size = width * height;\n        var out = new Uint16Array(size);\n        var r, g, b, max;\n        for (var i = 0; i < size; i++) {\n          r = img[4 * i];\n          g = img[4 * i + 1];\n          b = img[4 * i + 2];\n          max = r >= g && r >= b ? r : g >= b && g >= r ? g : b;\n          out[i] = max << 8;\n        }\n        return out;\n      }\n      module.exports = function unsharp(img, width, height, amount, radius, threshold) {\n        var v1, v2, vmul;\n        var diff, iTimes4;\n        if (amount === 0 || radius < 0.5) {\n          return;\n        }\n        if (radius > 2.0) {\n          radius = 2.0;\n        }\n        var brightness = hsv_v16(img, width, height);\n        var blured = new Uint16Array(brightness); // copy, because blur modify src\n\n        glur_mono16(blured, width, height, radius);\n        var amountFp = amount / 100 * 0x1000 + 0.5 | 0;\n        var thresholdFp = threshold << 8;\n        var size = width * height;\n        /* eslint-disable indent */\n\n        for (var i = 0; i < size; i++) {\n          v1 = brightness[i];\n          diff = v1 - blured[i];\n          if (Math.abs(diff) >= thresholdFp) {\n            // add unsharp mask to the brightness channel\n            v2 = v1 + (amountFp * diff + 0x800 >> 12); // Both v1 and v2 are within [0.0 .. 255.0] (0000-FF00) range, never going into\n            // [255.003 .. 255.996] (FF01-FFFF). This allows to round this value as (x+.5)|0\n            // later without overflowing.\n\n            v2 = v2 > 0xff00 ? 0xff00 : v2;\n            v2 = v2 < 0x0000 ? 0x0000 : v2; // Avoid division by 0. V=0 means rgb(0,0,0), unsharp with unsharpAmount>0 cannot\n            // change this value (because diff between colors gets inflated), so no need to verify correctness.\n\n            v1 = v1 !== 0 ? v1 : 1; // Multiplying V in HSV model by a constant is equivalent to multiplying each component\n            // in RGB by the same constant (same for HSL), see also:\n            // https://beesbuzz.biz/code/16-hsv-color-transforms\n\n            vmul = (v2 << 12) / v1 | 0; // Result will be in [0..255] range because:\n            //  - all numbers are positive\n            //  - r,g,b <= (v1/256)\n            //  - r,g,b,(v1/256),(v2/256) <= 255\n            // So highest this number can get is X*255/X+0.5=255.5 which is < 256 and rounds down.\n\n            iTimes4 = i * 4;\n            img[iTimes4] = img[iTimes4] * vmul + 0x800 >> 12; // R\n\n            img[iTimes4 + 1] = img[iTimes4 + 1] * vmul + 0x800 >> 12; // G\n\n            img[iTimes4 + 2] = img[iTimes4 + 2] * vmul + 0x800 >> 12; // B\n          }\n        }\n      };\n    }, {\n      \"glur/mono16\": 18\n    }],\n    11: [function (_dereq_, module, exports) {\n      'use strict';\n\n      module.exports = function unsharp(img, width, height, amount, radius, threshold) {\n        if (amount === 0 || radius < 0.5) {\n          return;\n        }\n        if (radius > 2.0) {\n          radius = 2.0;\n        }\n        var pixels = width * height;\n        var img_bytes_cnt = pixels * 4;\n        var hsv_bytes_cnt = pixels * 2;\n        var blur_bytes_cnt = pixels * 2;\n        var blur_line_byte_cnt = Math.max(width, height) * 4; // float32 array\n\n        var blur_coeffs_byte_cnt = 8 * 4; // float32 array\n\n        var img_offset = 0;\n        var hsv_offset = img_bytes_cnt;\n        var blur_offset = hsv_offset + hsv_bytes_cnt;\n        var blur_tmp_offset = blur_offset + blur_bytes_cnt;\n        var blur_line_offset = blur_tmp_offset + blur_bytes_cnt;\n        var blur_coeffs_offset = blur_line_offset + blur_line_byte_cnt;\n        var instance = this.__instance('unsharp_mask', img_bytes_cnt + hsv_bytes_cnt + blur_bytes_cnt * 2 + blur_line_byte_cnt + blur_coeffs_byte_cnt, {\n          exp: Math.exp\n        }); // 32-bit copy is much faster in chrome\n\n        var img32 = new Uint32Array(img.buffer);\n        var mem32 = new Uint32Array(this.__memory.buffer);\n        mem32.set(img32); // HSL\n\n        var fn = instance.exports.hsv_v16 || instance.exports._hsv_v16;\n        fn(img_offset, hsv_offset, width, height); // BLUR\n\n        fn = instance.exports.blurMono16 || instance.exports._blurMono16;\n        fn(hsv_offset, blur_offset, blur_tmp_offset, blur_line_offset, blur_coeffs_offset, width, height, radius); // UNSHARP\n\n        fn = instance.exports.unsharp || instance.exports._unsharp;\n        fn(img_offset, img_offset, hsv_offset, blur_offset, width, height, amount, threshold); // 32-bit copy is much faster in chrome\n\n        img32.set(new Uint32Array(this.__memory.buffer, 0, pixels));\n      };\n    }, {}],\n    12: [function (_dereq_, module, exports) {\n      // This is autogenerated file from math.wasm, don't edit.\n      //\n      'use strict';\n\n      /* eslint-disable max-len */\n      module.exports = 'AGFzbQEAAAAADAZkeWxpbmsAAAAAAAE0B2AAAGAEf39/fwBgBn9/f39/fwBgCH9/f39/f39/AGAIf39/f39/f30AYAJ9fwBgAXwBfAIZAgNlbnYDZXhwAAYDZW52Bm1lbW9yeQIAAAMHBgAFAgQBAwYGAX8AQQALB4oBCBFfX3dhc21fY2FsbF9jdG9ycwABFl9fYnVpbGRfZ2F1c3NpYW5fY29lZnMAAg5fX2dhdXNzMTZfbGluZQADCmJsdXJNb25vMTYABAdoc3ZfdjE2AAUHdW5zaGFycAAGDF9fZHNvX2hhbmRsZQMAGF9fd2FzbV9hcHBseV9kYXRhX3JlbG9jcwABCsUMBgMAAQvWAQEHfCABRNuGukOCGvs/IAC7oyICRAAAAAAAAADAohAAIgW2jDgCFCABIAKaEAAiAyADoCIGtjgCECABRAAAAAAAAPA/IAOhIgQgBKIgAyACIAKgokQAAAAAAADwP6AgBaGjIgS2OAIAIAEgBSAEmqIiB7Y4AgwgASADIAJEAAAAAAAA8D+gIASioiIItjgCCCABIAMgAkQAAAAAAADwv6AgBKKiIgK2OAIEIAEgByAIoCAFRAAAAAAAAPA/IAahoCIDo7Y4AhwgASAEIAKgIAOjtjgCGAuGBQMGfwl8An0gAyoCDCEVIAMqAgghFiADKgIUuyERIAMqAhC7IRACQCAEQQFrIghBAEgiCQRAIAIhByAAIQYMAQsgAiAALwEAuCIPIAMqAhi7oiIMIBGiIg0gDCAQoiAPIAMqAgS7IhOiIhQgAyoCALsiEiAPoqCgoCIOtjgCACACQQRqIQcgAEECaiEGIAhFDQAgCEEBIAhBAUgbIgpBf3MhCwJ/IAQgCmtBAXFFBEAgDiENIAgMAQsgAiANIA4gEKIgFCASIAAvAQK4Ig+ioKCgIg22OAIEIAJBCGohByAAQQRqIQYgDiEMIARBAmsLIQIgC0EAIARrRg0AA0AgByAMIBGiIA0gEKIgDyAToiASIAYvAQC4Ig6ioKCgIgy2OAIAIAcgDSARoiAMIBCiIA4gE6IgEiAGLwECuCIPoqCgoCINtjgCBCAHQQhqIQcgBkEEaiEGIAJBAkohACACQQJrIQIgAA0ACwsCQCAJDQAgASAFIAhsQQF0aiIAAn8gBkECay8BACICuCINIBW7IhKiIA0gFrsiE6KgIA0gAyoCHLuiIgwgEKKgIAwgEaKgIg8gB0EEayIHKgIAu6AiDkQAAAAAAADwQWMgDkQAAAAAAAAAAGZxBEAgDqsMAQtBAAs7AQAgCEUNACAGQQRrIQZBACAFa0EBdCEBA0ACfyANIBKiIAJB//8DcbgiDSAToqAgDyIOIBCioCAMIBGioCIPIAdBBGsiByoCALugIgxEAAAAAAAA8EFjIAxEAAAAAAAAAABmcQRAIAyrDAELQQALIQMgBi8BACECIAAgAWoiACADOwEAIAZBAmshBiAIQQFKIQMgDiEMIAhBAWshCCADDQALCwvRAgIBfwd8AkAgB0MAAAAAWw0AIARE24a6Q4Ia+z8gB0MAAAA/l7ujIglEAAAAAAAAAMCiEAAiDLaMOAIUIAQgCZoQACIKIAqgIg22OAIQIAREAAAAAAAA8D8gCqEiCyALoiAKIAkgCaCiRAAAAAAAAPA/oCAMoaMiC7Y4AgAgBCAMIAuaoiIOtjgCDCAEIAogCUQAAAAAAADwP6AgC6KiIg+2OAIIIAQgCiAJRAAAAAAAAPC/oCALoqIiCbY4AgQgBCAOIA+gIAxEAAAAAAAA8D8gDaGgIgqjtjgCHCAEIAsgCaAgCqO2OAIYIAYEQANAIAAgBSAIbEEBdGogAiAIQQF0aiADIAQgBSAGEAMgCEEBaiIIIAZHDQALCyAFRQ0AQQAhCANAIAIgBiAIbEEBdGogASAIQQF0aiADIAQgBiAFEAMgCEEBaiIIIAVHDQALCwtxAQN/IAIgA2wiBQRAA0AgASAAKAIAIgRBEHZB/wFxIgIgAiAEQQh2Qf8BcSIDIAMgBEH/AXEiBEkbIAIgA0sbIgYgBiAEIAIgBEsbIAMgBEsbQQh0OwEAIAFBAmohASAAQQRqIQAgBUEBayIFDQALCwuZAgIDfwF8IAQgBWwhBAJ/IAazQwAAgEWUQwAAyEKVu0QAAAAAAADgP6AiC5lEAAAAAAAA4EFjBEAgC6oMAQtBgICAgHgLIQUgBARAIAdBCHQhCUEAIQYDQCAJIAIgBkEBdCIHai8BACIBIAMgB2ovAQBrIgcgB0EfdSIIaiAIc00EQCAAIAZBAnQiCGoiCiAFIAdsQYAQakEMdSABaiIHQYD+AyAHQYD+A0gbIgdBACAHQQBKG0EMdCABQQEgARtuIgEgCi0AAGxBgBBqQQx2OgAAIAAgCEEBcmoiByABIActAABsQYAQakEMdjoAACAAIAhBAnJqIgcgASAHLQAAbEGAEGpBDHY6AAALIAZBAWoiBiAERw0ACwsL';\n    }, {}],\n    13: [function (_dereq_, module, exports) {\n      'use strict';\n\n      var GC_INTERVAL = 100;\n      function Pool(create, idle) {\n        this.create = create;\n        this.available = [];\n        this.acquired = {};\n        this.lastId = 1;\n        this.timeoutId = 0;\n        this.idle = idle || 2000;\n      }\n      Pool.prototype.acquire = function () {\n        var _this = this;\n        var resource;\n        if (this.available.length !== 0) {\n          resource = this.available.pop();\n        } else {\n          resource = this.create();\n          resource.id = this.lastId++;\n          resource.release = function () {\n            return _this.release(resource);\n          };\n        }\n        this.acquired[resource.id] = resource;\n        return resource;\n      };\n      Pool.prototype.release = function (resource) {\n        var _this2 = this;\n        delete this.acquired[resource.id];\n        resource.lastUsed = Date.now();\n        this.available.push(resource);\n        if (this.timeoutId === 0) {\n          this.timeoutId = setTimeout(function () {\n            return _this2.gc();\n          }, GC_INTERVAL);\n        }\n      };\n      Pool.prototype.gc = function () {\n        var _this3 = this;\n        var now = Date.now();\n        this.available = this.available.filter(function (resource) {\n          if (now - resource.lastUsed > _this3.idle) {\n            resource.destroy();\n            return false;\n          }\n          return true;\n        });\n        if (this.available.length !== 0) {\n          this.timeoutId = setTimeout(function () {\n            return _this3.gc();\n          }, GC_INTERVAL);\n        } else {\n          this.timeoutId = 0;\n        }\n      };\n      module.exports = Pool;\n    }, {}],\n    14: [function (_dereq_, module, exports) {\n      // Add intermediate resizing steps when scaling down by a very large factor.\n      //\n      // For example, when resizing 10000x10000 down to 10x10, it'll resize it to\n      // 300x300 first.\n      //\n      // It's needed because tiler has issues when the entire tile is scaled down\n      // to a few pixels (1024px source tile with border size 3 should result in\n      // at least 3+3+2 = 8px target tile, so max scale factor is 128 here).\n      //\n      // Also, adding intermediate steps can speed up processing if we use lower\n      // quality algorithms for first stages.\n      //\n      'use strict';\n\n      // min size = 0 results in infinite loop,\n      // min size = 1 can consume large amount of memory\n      var MIN_INNER_TILE_SIZE = 2;\n      module.exports = function createStages(fromWidth, fromHeight, toWidth, toHeight, srcTileSize, destTileBorder) {\n        var scaleX = toWidth / fromWidth;\n        var scaleY = toHeight / fromHeight; // derived from createRegions equation:\n        // innerTileWidth = pixelFloor(srcTileSize * scaleX) - 2 * destTileBorder;\n\n        var minScale = (2 * destTileBorder + MIN_INNER_TILE_SIZE + 1) / srcTileSize; // refuse to scale image multiple times by less than twice each time,\n        // it could only happen because of invalid options\n\n        if (minScale > 0.5) return [[toWidth, toHeight]];\n        var stageCount = Math.ceil(Math.log(Math.min(scaleX, scaleY)) / Math.log(minScale)); // no additional resizes are necessary,\n        // stageCount can be zero or be negative when enlarging the image\n\n        if (stageCount <= 1) return [[toWidth, toHeight]];\n        var result = [];\n        for (var i = 0; i < stageCount; i++) {\n          var width = Math.round(Math.pow(Math.pow(fromWidth, stageCount - i - 1) * Math.pow(toWidth, i + 1), 1 / stageCount));\n          var height = Math.round(Math.pow(Math.pow(fromHeight, stageCount - i - 1) * Math.pow(toHeight, i + 1), 1 / stageCount));\n          result.push([width, height]);\n        }\n        return result;\n      };\n    }, {}],\n    15: [function (_dereq_, module, exports) {\n      // Split original image into multiple 1024x1024 chunks to reduce memory usage\n      // (images have to be unpacked into typed arrays for resizing) and allow\n      // parallel processing of multiple tiles at a time.\n      //\n      'use strict';\n\n      /*\n       * pixelFloor and pixelCeil are modified versions of Math.floor and Math.ceil\n       * functions which take into account floating point arithmetic errors.\n       * Those errors can cause undesired increments/decrements of sizes and offsets:\n       * Math.ceil(36 / (36 / 500)) = 501\n       * pixelCeil(36 / (36 / 500)) = 500\n       */\n      var PIXEL_EPSILON = 1e-5;\n      function pixelFloor(x) {\n        var nearest = Math.round(x);\n        if (Math.abs(x - nearest) < PIXEL_EPSILON) {\n          return nearest;\n        }\n        return Math.floor(x);\n      }\n      function pixelCeil(x) {\n        var nearest = Math.round(x);\n        if (Math.abs(x - nearest) < PIXEL_EPSILON) {\n          return nearest;\n        }\n        return Math.ceil(x);\n      }\n      module.exports = function createRegions(options) {\n        var scaleX = options.toWidth / options.width;\n        var scaleY = options.toHeight / options.height;\n        var innerTileWidth = pixelFloor(options.srcTileSize * scaleX) - 2 * options.destTileBorder;\n        var innerTileHeight = pixelFloor(options.srcTileSize * scaleY) - 2 * options.destTileBorder; // prevent infinite loop, this should never happen\n\n        if (innerTileWidth < 1 || innerTileHeight < 1) {\n          throw new Error('Internal error in pica: target tile width/height is too small.');\n        }\n        var x, y;\n        var innerX, innerY, toTileWidth, toTileHeight;\n        var tiles = [];\n        var tile; // we go top-to-down instead of left-to-right to make image displayed from top to\n        // doesn in the browser\n\n        for (innerY = 0; innerY < options.toHeight; innerY += innerTileHeight) {\n          for (innerX = 0; innerX < options.toWidth; innerX += innerTileWidth) {\n            x = innerX - options.destTileBorder;\n            if (x < 0) {\n              x = 0;\n            }\n            toTileWidth = innerX + innerTileWidth + options.destTileBorder - x;\n            if (x + toTileWidth >= options.toWidth) {\n              toTileWidth = options.toWidth - x;\n            }\n            y = innerY - options.destTileBorder;\n            if (y < 0) {\n              y = 0;\n            }\n            toTileHeight = innerY + innerTileHeight + options.destTileBorder - y;\n            if (y + toTileHeight >= options.toHeight) {\n              toTileHeight = options.toHeight - y;\n            }\n            tile = {\n              toX: x,\n              toY: y,\n              toWidth: toTileWidth,\n              toHeight: toTileHeight,\n              toInnerX: innerX,\n              toInnerY: innerY,\n              toInnerWidth: innerTileWidth,\n              toInnerHeight: innerTileHeight,\n              offsetX: x / scaleX - pixelFloor(x / scaleX),\n              offsetY: y / scaleY - pixelFloor(y / scaleY),\n              scaleX: scaleX,\n              scaleY: scaleY,\n              x: pixelFloor(x / scaleX),\n              y: pixelFloor(y / scaleY),\n              width: pixelCeil(toTileWidth / scaleX),\n              height: pixelCeil(toTileHeight / scaleY)\n            };\n            tiles.push(tile);\n          }\n        }\n        return tiles;\n      };\n    }, {}],\n    16: [function (_dereq_, module, exports) {\n      'use strict';\n\n      function objClass(obj) {\n        return Object.prototype.toString.call(obj);\n      }\n      module.exports.isCanvas = function isCanvas(element) {\n        var cname = objClass(element);\n        return cname === '[object HTMLCanvasElement]'\n        /* browser */ || cname === '[object OffscreenCanvas]' || cname === '[object Canvas]'\n        /* node-canvas */;\n      };\n\n      module.exports.isImage = function isImage(element) {\n        return objClass(element) === '[object HTMLImageElement]';\n      };\n      module.exports.isImageBitmap = function isImageBitmap(element) {\n        return objClass(element) === '[object ImageBitmap]';\n      };\n      module.exports.limiter = function limiter(concurrency) {\n        var active = 0,\n          queue = [];\n        function roll() {\n          if (active < concurrency && queue.length) {\n            active++;\n            queue.shift()();\n          }\n        }\n        return function limit(fn) {\n          return new Promise(function (resolve, reject) {\n            queue.push(function () {\n              fn().then(function (result) {\n                resolve(result);\n                active--;\n                roll();\n              }, function (err) {\n                reject(err);\n                active--;\n                roll();\n              });\n            });\n            roll();\n          });\n        };\n      };\n      module.exports.cib_quality_name = function cib_quality_name(num) {\n        switch (num) {\n          case 0:\n            return 'pixelated';\n          case 1:\n            return 'low';\n          case 2:\n            return 'medium';\n        }\n        return 'high';\n      };\n      module.exports.cib_support = function cib_support(createCanvas) {\n        return Promise.resolve().then(function () {\n          if (typeof createImageBitmap === 'undefined') {\n            return false;\n          }\n          var c = createCanvas(100, 100);\n          return createImageBitmap(c, 0, 0, 100, 100, {\n            resizeWidth: 10,\n            resizeHeight: 10,\n            resizeQuality: 'high'\n          }).then(function (bitmap) {\n            var status = bitmap.width === 10; // Branch below is filtered on upper level. We do not call resize\n            // detection for basic ImageBitmap.\n            //\n            // https://developer.mozilla.org/en-US/docs/Web/API/ImageBitmap\n            // old Crome 51 has ImageBitmap without .close(). Then this code\n            // will throw and return 'false' as expected.\n            //\n\n            bitmap.close();\n            c = null;\n            return status;\n          });\n        })[\"catch\"](function () {\n          return false;\n        });\n      };\n      module.exports.worker_offscreen_canvas_support = function worker_offscreen_canvas_support() {\n        return new Promise(function (resolve, reject) {\n          if (typeof OffscreenCanvas === 'undefined') {\n            // if OffscreenCanvas is present, we assume browser supports Worker and built-in Promise as well\n            resolve(false);\n            return;\n          }\n          function workerPayload(self) {\n            if (typeof createImageBitmap === 'undefined') {\n              self.postMessage(false);\n              return;\n            }\n            Promise.resolve().then(function () {\n              var canvas = new OffscreenCanvas(10, 10); // test that 2d context can be used in worker\n\n              var ctx = canvas.getContext('2d');\n              ctx.rect(0, 0, 1, 1); // test that cib can be used to return image bitmap from worker\n\n              return createImageBitmap(canvas, 0, 0, 1, 1);\n            }).then(function () {\n              return self.postMessage(true);\n            }, function () {\n              return self.postMessage(false);\n            });\n          }\n          var code = btoa(\"(\".concat(workerPayload.toString(), \")(self);\"));\n          var w = new Worker(\"data:text/javascript;base64,\".concat(code));\n          w.onmessage = function (ev) {\n            return resolve(ev.data);\n          };\n          w.onerror = reject;\n        }).then(function (result) {\n          return result;\n        }, function () {\n          return false;\n        });\n      }; // Check if canvas.getContext('2d').getImageData can be used,\n      // FireFox randomizes the output of that function in `privacy.resistFingerprinting` mode\n\n      module.exports.can_use_canvas = function can_use_canvas(createCanvas) {\n        var usable = false;\n        try {\n          var canvas = createCanvas(2, 1);\n          var ctx = canvas.getContext('2d');\n          var d = ctx.createImageData(2, 1);\n          d.data[0] = 12;\n          d.data[1] = 23;\n          d.data[2] = 34;\n          d.data[3] = 255;\n          d.data[4] = 45;\n          d.data[5] = 56;\n          d.data[6] = 67;\n          d.data[7] = 255;\n          ctx.putImageData(d, 0, 0);\n          d = null;\n          d = ctx.getImageData(0, 0, 2, 1);\n          if (d.data[0] === 12 && d.data[1] === 23 && d.data[2] === 34 && d.data[3] === 255 && d.data[4] === 45 && d.data[5] === 56 && d.data[6] === 67 && d.data[7] === 255) {\n            usable = true;\n          }\n        } catch (err) {}\n        return usable;\n      }; // Check if createImageBitmap(img, sx, sy, sw, sh) signature works correctly\n      // with JPEG images oriented with Exif;\n      // https://bugs.chromium.org/p/chromium/issues/detail?id=1220671\n      // TODO: remove after it's fixed in chrome for at least 2 releases\n\n      module.exports.cib_can_use_region = function cib_can_use_region() {\n        return new Promise(function (resolve) {\n          // `Image` check required for use in `ServiceWorker`\n          if (typeof Image === 'undefined' || typeof createImageBitmap === 'undefined') {\n            resolve(false);\n            return;\n          }\n          var image = new Image();\n          image.src = 'data:image/jpeg;base64,' + '/9j/4QBiRXhpZgAATU0AKgAAAAgABQESAAMAAAABAAYAAAEaAAUAAAABAAAASgEbAAUAA' + 'AABAAAAUgEoAAMAAAABAAIAAAITAAMAAAABAAEAAAAAAAAAAABIAAAAAQAAAEgAAAAB/9' + 'sAQwAEAwMEAwMEBAMEBQQEBQYKBwYGBgYNCQoICg8NEBAPDQ8OERMYFBESFxIODxUcFRc' + 'ZGRsbGxAUHR8dGh8YGhsa/9sAQwEEBQUGBQYMBwcMGhEPERoaGhoaGhoaGhoaGhoaGhoa' + 'GhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoa/8IAEQgAAQACAwERAAIRAQMRA' + 'f/EABQAAQAAAAAAAAAAAAAAAAAAAAf/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAA' + 'IQAxAAAAF/P//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAQUCf//EABQRAQAAAAA' + 'AAAAAAAAAAAAAAAD/2gAIAQMBAT8Bf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQIB' + 'AT8Bf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEABj8Cf//EABQQAQAAAAAAAAAAA' + 'AAAAAAAAAD/2gAIAQEAAT8hf//aAAwDAQACAAMAAAAQH//EABQRAQAAAAAAAAAAAAAAAA' + 'AAAAD/2gAIAQMBAT8Qf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQIBAT8Qf//EABQ' + 'QAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAT8Qf//Z';\n          image.onload = function () {\n            createImageBitmap(image, 0, 0, image.width, image.height).then(function (bitmap) {\n              if (bitmap.width === image.width && bitmap.height === image.height) {\n                resolve(true);\n              } else {\n                resolve(false);\n              }\n            }, function () {\n              return resolve(false);\n            });\n          };\n          image.onerror = function () {\n            return resolve(false);\n          };\n        });\n      };\n    }, {}],\n    17: [function (_dereq_, module, exports) {\n      // Web Worker wrapper for image resize function\n      'use strict';\n\n      module.exports = function () {\n        var MathLib = _dereq_('./mathlib');\n        var mathLib;\n        /* eslint-disable no-undef */\n\n        onmessage = function onmessage(ev) {\n          var tileOpts = ev.data.opts;\n          var returnBitmap = false;\n          if (!tileOpts.src && tileOpts.srcBitmap) {\n            var canvas = new OffscreenCanvas(tileOpts.width, tileOpts.height);\n            var ctx = canvas.getContext('2d');\n            ctx.drawImage(tileOpts.srcBitmap, 0, 0);\n            tileOpts.src = ctx.getImageData(0, 0, tileOpts.width, tileOpts.height).data;\n            canvas.width = canvas.height = 0;\n            canvas = null;\n            tileOpts.srcBitmap.close();\n            tileOpts.srcBitmap = null; // Temporary force out data to typed array, because Chrome have artefacts\n            // https://github.com/nodeca/pica/issues/223\n            // returnBitmap = true;\n          }\n\n          if (!mathLib) mathLib = new MathLib(ev.data.features); // Use multimath's sync auto-init. Avoid Promise use in old browsers,\n          // because polyfills are not propagated to webworker.\n\n          var data = mathLib.resizeAndUnsharp(tileOpts);\n          if (returnBitmap) {\n            var toImageData = new ImageData(new Uint8ClampedArray(data), tileOpts.toWidth, tileOpts.toHeight);\n            var _canvas = new OffscreenCanvas(tileOpts.toWidth, tileOpts.toHeight);\n            var _ctx = _canvas.getContext('2d');\n            _ctx.putImageData(toImageData, 0, 0);\n            createImageBitmap(_canvas).then(function (bitmap) {\n              postMessage({\n                bitmap: bitmap\n              }, [bitmap]);\n            });\n          } else {\n            postMessage({\n              data: data\n            }, [data.buffer]);\n          }\n        };\n      };\n    }, {\n      \"./mathlib\": 1\n    }],\n    18: [function (_dereq_, module, exports) {\n      // Calculate Gaussian blur of an image using IIR filter\n      // The method is taken from Intel's white paper and code example attached to it:\n      // https://software.intel.com/en-us/articles/iir-gaussian-blur-filter\n      // -implementation-using-intel-advanced-vector-extensions\n\n      var a0, a1, a2, a3, b1, b2, left_corner, right_corner;\n      function gaussCoef(sigma) {\n        if (sigma < 0.5) {\n          sigma = 0.5;\n        }\n        var a = Math.exp(0.726 * 0.726) / sigma,\n          g1 = Math.exp(-a),\n          g2 = Math.exp(-2 * a),\n          k = (1 - g1) * (1 - g1) / (1 + 2 * a * g1 - g2);\n        a0 = k;\n        a1 = k * (a - 1) * g1;\n        a2 = k * (a + 1) * g1;\n        a3 = -k * g2;\n        b1 = 2 * g1;\n        b2 = -g2;\n        left_corner = (a0 + a1) / (1 - b1 - b2);\n        right_corner = (a2 + a3) / (1 - b1 - b2);\n\n        // Attempt to force type to FP32.\n        return new Float32Array([a0, a1, a2, a3, b1, b2, left_corner, right_corner]);\n      }\n      function convolveMono16(src, out, line, coeff, width, height) {\n        // takes src image and writes the blurred and transposed result into out\n\n        var prev_src, curr_src, curr_out, prev_out, prev_prev_out;\n        var src_index, out_index, line_index;\n        var i, j;\n        var coeff_a0, coeff_a1, coeff_b1, coeff_b2;\n        for (i = 0; i < height; i++) {\n          src_index = i * width;\n          out_index = i;\n          line_index = 0;\n\n          // left to right\n          prev_src = src[src_index];\n          prev_prev_out = prev_src * coeff[6];\n          prev_out = prev_prev_out;\n          coeff_a0 = coeff[0];\n          coeff_a1 = coeff[1];\n          coeff_b1 = coeff[4];\n          coeff_b2 = coeff[5];\n          for (j = 0; j < width; j++) {\n            curr_src = src[src_index];\n            curr_out = curr_src * coeff_a0 + prev_src * coeff_a1 + prev_out * coeff_b1 + prev_prev_out * coeff_b2;\n            prev_prev_out = prev_out;\n            prev_out = curr_out;\n            prev_src = curr_src;\n            line[line_index] = prev_out;\n            line_index++;\n            src_index++;\n          }\n          src_index--;\n          line_index--;\n          out_index += height * (width - 1);\n\n          // right to left\n          prev_src = src[src_index];\n          prev_prev_out = prev_src * coeff[7];\n          prev_out = prev_prev_out;\n          curr_src = prev_src;\n          coeff_a0 = coeff[2];\n          coeff_a1 = coeff[3];\n          for (j = width - 1; j >= 0; j--) {\n            curr_out = curr_src * coeff_a0 + prev_src * coeff_a1 + prev_out * coeff_b1 + prev_prev_out * coeff_b2;\n            prev_prev_out = prev_out;\n            prev_out = curr_out;\n            prev_src = curr_src;\n            curr_src = src[src_index];\n            out[out_index] = line[line_index] + prev_out;\n            src_index--;\n            line_index--;\n            out_index -= height;\n          }\n        }\n      }\n      function blurMono16(src, width, height, radius) {\n        // Quick exit on zero radius\n        if (!radius) {\n          return;\n        }\n        var out = new Uint16Array(src.length),\n          tmp_line = new Float32Array(Math.max(width, height));\n        var coeff = gaussCoef(radius);\n        convolveMono16(src, out, tmp_line, coeff, width, height, radius);\n        convolveMono16(out, src, tmp_line, coeff, height, width, radius);\n      }\n      module.exports = blurMono16;\n    }, {}],\n    19: [function (_dereq_, module, exports) {\n      'use strict';\n\n      var assign = _dereq_('object-assign');\n      var base64decode = _dereq_('./lib/base64decode');\n      var hasWebAssembly = _dereq_('./lib/wa_detect');\n      var DEFAULT_OPTIONS = {\n        js: true,\n        wasm: true\n      };\n      function MultiMath(options) {\n        if (!(this instanceof MultiMath)) return new MultiMath(options);\n        var opts = assign({}, DEFAULT_OPTIONS, options || {});\n        this.options = opts;\n        this.__cache = {};\n        this.__init_promise = null;\n        this.__modules = opts.modules || {};\n        this.__memory = null;\n        this.__wasm = {};\n        this.__isLE = new Uint32Array(new Uint8Array([1, 0, 0, 0]).buffer)[0] === 1;\n        if (!this.options.js && !this.options.wasm) {\n          throw new Error('mathlib: at least \"js\" or \"wasm\" should be enabled');\n        }\n      }\n      MultiMath.prototype.has_wasm = hasWebAssembly;\n      MultiMath.prototype.use = function (module) {\n        this.__modules[module.name] = module;\n\n        // Pin the best possible implementation\n        if (this.options.wasm && this.has_wasm() && module.wasm_fn) {\n          this[module.name] = module.wasm_fn;\n        } else {\n          this[module.name] = module.fn;\n        }\n        return this;\n      };\n      MultiMath.prototype.init = function () {\n        if (this.__init_promise) return this.__init_promise;\n        if (!this.options.js && this.options.wasm && !this.has_wasm()) {\n          return Promise.reject(new Error('mathlib: only \"wasm\" was enabled, but it\\'s not supported'));\n        }\n        var self = this;\n        this.__init_promise = Promise.all(Object.keys(self.__modules).map(function (name) {\n          var module = self.__modules[name];\n          if (!self.options.wasm || !self.has_wasm() || !module.wasm_fn) return null;\n\n          // If already compiled - exit\n          if (self.__wasm[name]) return null;\n\n          // Compile wasm source\n          return WebAssembly.compile(self.__base64decode(module.wasm_src)).then(function (m) {\n            self.__wasm[name] = m;\n          });\n        })).then(function () {\n          return self;\n        });\n        return this.__init_promise;\n      };\n\n      ////////////////////////////////////////////////////////////////////////////////\n      // Methods below are for internal use from plugins\n\n      // Simple decode base64 to typed array. Useful to load embedded webassembly\n      // code. You probably don't need to call this method directly.\n      //\n      MultiMath.prototype.__base64decode = base64decode;\n\n      // Increase current memory to include specified number of bytes. Do nothing if\n      // size is already ok. You probably don't need to call this method directly,\n      // because it will be invoked from `.__instance()`.\n      //\n      MultiMath.prototype.__reallocate = function mem_grow_to(bytes) {\n        if (!this.__memory) {\n          this.__memory = new WebAssembly.Memory({\n            initial: Math.ceil(bytes / (64 * 1024))\n          });\n          return this.__memory;\n        }\n        var mem_size = this.__memory.buffer.byteLength;\n        if (mem_size < bytes) {\n          this.__memory.grow(Math.ceil((bytes - mem_size) / (64 * 1024)));\n        }\n        return this.__memory;\n      };\n\n      // Returns instantinated webassembly item by name, with specified memory size\n      // and environment.\n      // - use cache if available\n      // - do sync module init, if async init was not called earlier\n      // - allocate memory if not enougth\n      // - can export functions to webassembly via \"env_extra\",\n      //   for example, { exp: Math.exp }\n      //\n      MultiMath.prototype.__instance = function instance(name, memsize, env_extra) {\n        if (memsize) this.__reallocate(memsize);\n\n        // If .init() was not called, do sync compile\n        if (!this.__wasm[name]) {\n          var module = this.__modules[name];\n          this.__wasm[name] = new WebAssembly.Module(this.__base64decode(module.wasm_src));\n        }\n        if (!this.__cache[name]) {\n          var env_base = {\n            memoryBase: 0,\n            memory: this.__memory,\n            tableBase: 0,\n            table: new WebAssembly.Table({\n              initial: 0,\n              element: 'anyfunc'\n            })\n          };\n          this.__cache[name] = new WebAssembly.Instance(this.__wasm[name], {\n            env: assign(env_base, env_extra || {})\n          });\n        }\n        return this.__cache[name];\n      };\n\n      // Helper to calculate memory aligh for pointers. Webassembly does not require\n      // this, but you may wish to experiment. Default base = 8;\n      //\n      MultiMath.prototype.__align = function align(number, base) {\n        base = base || 8;\n        var reminder = number % base;\n        return number + (reminder ? base - reminder : 0);\n      };\n      module.exports = MultiMath;\n    }, {\n      \"./lib/base64decode\": 20,\n      \"./lib/wa_detect\": 21,\n      \"object-assign\": 22\n    }],\n    20: [function (_dereq_, module, exports) {\n      // base64 decode str -> Uint8Array, to load WA modules\n      //\n      'use strict';\n\n      var BASE64_MAP = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n      module.exports = function base64decode(str) {\n        var input = str.replace(/[\\r\\n=]/g, ''),\n          // remove CR/LF & padding to simplify scan\n          max = input.length;\n        var out = new Uint8Array(max * 3 >> 2);\n\n        // Collect by 6*4 bits (3 bytes)\n\n        var bits = 0;\n        var ptr = 0;\n        for (var idx = 0; idx < max; idx++) {\n          if (idx % 4 === 0 && idx) {\n            out[ptr++] = bits >> 16 & 0xFF;\n            out[ptr++] = bits >> 8 & 0xFF;\n            out[ptr++] = bits & 0xFF;\n          }\n          bits = bits << 6 | BASE64_MAP.indexOf(input.charAt(idx));\n        }\n\n        // Dump tail\n\n        var tailbits = max % 4 * 6;\n        if (tailbits === 0) {\n          out[ptr++] = bits >> 16 & 0xFF;\n          out[ptr++] = bits >> 8 & 0xFF;\n          out[ptr++] = bits & 0xFF;\n        } else if (tailbits === 18) {\n          out[ptr++] = bits >> 10 & 0xFF;\n          out[ptr++] = bits >> 2 & 0xFF;\n        } else if (tailbits === 12) {\n          out[ptr++] = bits >> 4 & 0xFF;\n        }\n        return out;\n      };\n    }, {}],\n    21: [function (_dereq_, module, exports) {\n      // Detect WebAssembly support.\n      // - Check global WebAssembly object\n      // - Try to load simple module (can be disabled via CSP)\n      //\n      'use strict';\n\n      var wa;\n      module.exports = function hasWebAssembly() {\n        // use cache if called before;\n        if (typeof wa !== 'undefined') return wa;\n        wa = false;\n        if (typeof WebAssembly === 'undefined') return wa;\n\n        // If WebAssenbly is disabled, code can throw on compile\n        try {\n          // https://github.com/brion/min-wasm-fail/blob/master/min-wasm-fail.in.js\n          // Additional check that WA internals are correct\n\n          /* eslint-disable comma-spacing, max-len */\n          var bin = new Uint8Array([0, 97, 115, 109, 1, 0, 0, 0, 1, 6, 1, 96, 1, 127, 1, 127, 3, 2, 1, 0, 5, 3, 1, 0, 1, 7, 8, 1, 4, 116, 101, 115, 116, 0, 0, 10, 16, 1, 14, 0, 32, 0, 65, 1, 54, 2, 0, 32, 0, 40, 2, 0, 11]);\n          var module = new WebAssembly.Module(bin);\n          var instance = new WebAssembly.Instance(module, {});\n\n          // test storing to and loading from a non-zero location via a parameter.\n          // Safari on iOS 11.2.5 returns 0 unexpectedly at non-zero locations\n          if (instance.exports.test(4) !== 0) wa = true;\n          return wa;\n        } catch (__) {}\n        return wa;\n      };\n    }, {}],\n    22: [function (_dereq_, module, exports) {\n      /*\n      object-assign\n      (c) Sindre Sorhus\n      @license MIT\n      */\n\n      'use strict';\n\n      /* eslint-disable no-unused-vars */\n      var getOwnPropertySymbols = Object.getOwnPropertySymbols;\n      var hasOwnProperty = Object.prototype.hasOwnProperty;\n      var propIsEnumerable = Object.prototype.propertyIsEnumerable;\n      function toObject(val) {\n        if (val === null || val === undefined) {\n          throw new TypeError('Object.assign cannot be called with null or undefined');\n        }\n        return Object(val);\n      }\n      function shouldUseNative() {\n        try {\n          if (!Object.assign) {\n            return false;\n          }\n\n          // Detect buggy property enumeration order in older V8 versions.\n\n          // https://bugs.chromium.org/p/v8/issues/detail?id=4118\n          var test1 = new String('abc'); // eslint-disable-line no-new-wrappers\n          test1[5] = 'de';\n          if (Object.getOwnPropertyNames(test1)[0] === '5') {\n            return false;\n          }\n\n          // https://bugs.chromium.org/p/v8/issues/detail?id=3056\n          var test2 = {};\n          for (var i = 0; i < 10; i++) {\n            test2['_' + String.fromCharCode(i)] = i;\n          }\n          var order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n            return test2[n];\n          });\n          if (order2.join('') !== '0123456789') {\n            return false;\n          }\n\n          // https://bugs.chromium.org/p/v8/issues/detail?id=3056\n          var test3 = {};\n          'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n            test3[letter] = letter;\n          });\n          if (Object.keys(Object.assign({}, test3)).join('') !== 'abcdefghijklmnopqrst') {\n            return false;\n          }\n          return true;\n        } catch (err) {\n          // We don't expect any of the above to throw, but better to be safe.\n          return false;\n        }\n      }\n      module.exports = shouldUseNative() ? Object.assign : function (target, source) {\n        var from;\n        var to = toObject(target);\n        var symbols;\n        for (var s = 1; s < arguments.length; s++) {\n          from = Object(arguments[s]);\n          for (var key in from) {\n            if (hasOwnProperty.call(from, key)) {\n              to[key] = from[key];\n            }\n          }\n          if (getOwnPropertySymbols) {\n            symbols = getOwnPropertySymbols(from);\n            for (var i = 0; i < symbols.length; i++) {\n              if (propIsEnumerable.call(from, symbols[i])) {\n                to[symbols[i]] = from[symbols[i]];\n              }\n            }\n          }\n        }\n        return to;\n      };\n    }, {}],\n    23: [function (_dereq_, module, exports) {\n      var bundleFn = arguments[3];\n      var sources = arguments[4];\n      var cache = arguments[5];\n      var stringify = JSON.stringify;\n      module.exports = function (fn, options) {\n        var wkey;\n        var cacheKeys = Object.keys(cache);\n        for (var i = 0, l = cacheKeys.length; i < l; i++) {\n          var key = cacheKeys[i];\n          var exp = cache[key].exports;\n          // Using babel as a transpiler to use esmodule, the export will always\n          // be an object with the default export as a property of it. To ensure\n          // the existing api and babel esmodule exports are both supported we\n          // check for both\n          if (exp === fn || exp && exp.default === fn) {\n            wkey = key;\n            break;\n          }\n        }\n        if (!wkey) {\n          wkey = Math.floor(Math.pow(16, 8) * Math.random()).toString(16);\n          var wcache = {};\n          for (var i = 0, l = cacheKeys.length; i < l; i++) {\n            var key = cacheKeys[i];\n            wcache[key] = key;\n          }\n          sources[wkey] = ['function(require,module,exports){' + fn + '(self); }', wcache];\n        }\n        var skey = Math.floor(Math.pow(16, 8) * Math.random()).toString(16);\n        var scache = {};\n        scache[wkey] = wkey;\n        sources[skey] = ['function(require,module,exports){' +\n        // try to call default if defined to also support babel esmodule exports\n        'var f = require(' + stringify(wkey) + ');' + '(f.default ? f.default : f)(self);' + '}', scache];\n        var workerSources = {};\n        resolveSources(skey);\n        function resolveSources(key) {\n          workerSources[key] = true;\n          for (var depPath in sources[key][1]) {\n            var depKey = sources[key][1][depPath];\n            if (!workerSources[depKey]) {\n              resolveSources(depKey);\n            }\n          }\n        }\n        var src = '(' + bundleFn + ')({' + Object.keys(workerSources).map(function (key) {\n          return stringify(key) + ':[' + sources[key][0] + ',' + stringify(sources[key][1]) + ']';\n        }).join(',') + '},{},[' + stringify(skey) + '])';\n        var URL = window.URL || window.webkitURL || window.mozURL || window.msURL;\n        var blob = new Blob([src], {\n          type: 'text/javascript'\n        });\n        if (options && options.bare) {\n          return blob;\n        }\n        var workerUrl = URL.createObjectURL(blob);\n        var worker = new Worker(workerUrl);\n        worker.objectURL = workerUrl;\n        return worker;\n      };\n    }, {}],\n    \"/index.js\": [function (_dereq_, module, exports) {\n      'use strict';\n\n      function _slicedToArray(arr, i) {\n        return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n      }\n      function _nonIterableRest() {\n        throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n      }\n      function _unsupportedIterableToArray(o, minLen) {\n        if (!o) return;\n        if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n        var n = Object.prototype.toString.call(o).slice(8, -1);\n        if (n === \"Object\" && o.constructor) n = o.constructor.name;\n        if (n === \"Map\" || n === \"Set\") return Array.from(o);\n        if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n      }\n      function _arrayLikeToArray(arr, len) {\n        if (len == null || len > arr.length) len = arr.length;\n        for (var i = 0, arr2 = new Array(len); i < len; i++) {\n          arr2[i] = arr[i];\n        }\n        return arr2;\n      }\n      function _iterableToArrayLimit(arr, i) {\n        var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"];\n        if (_i == null) return;\n        var _arr = [];\n        var _n = true;\n        var _d = false;\n        var _s, _e;\n        try {\n          for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n            _arr.push(_s.value);\n            if (i && _arr.length === i) break;\n          }\n        } catch (err) {\n          _d = true;\n          _e = err;\n        } finally {\n          try {\n            if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n          } finally {\n            if (_d) throw _e;\n          }\n        }\n        return _arr;\n      }\n      function _arrayWithHoles(arr) {\n        if (Array.isArray(arr)) return arr;\n      }\n      var assign = _dereq_('object-assign');\n      var webworkify = _dereq_('webworkify');\n      var MathLib = _dereq_('./lib/mathlib');\n      var Pool = _dereq_('./lib/pool');\n      var utils = _dereq_('./lib/utils');\n      var worker = _dereq_('./lib/worker');\n      var createStages = _dereq_('./lib/stepper');\n      var createRegions = _dereq_('./lib/tiler');\n      var filter_info = _dereq_('./lib/mm_resize/resize_filter_info'); // Deduplicate pools & limiters with the same configs\n      // when user creates multiple pica instances.\n\n      var singletones = {};\n      var NEED_SAFARI_FIX = false;\n      try {\n        if (typeof navigator !== 'undefined' && navigator.userAgent) {\n          NEED_SAFARI_FIX = navigator.userAgent.indexOf('Safari') >= 0;\n        }\n      } catch (e) {}\n      var concurrency = 1;\n      if (typeof navigator !== 'undefined') {\n        concurrency = Math.min(navigator.hardwareConcurrency || 1, 4);\n      }\n      var DEFAULT_PICA_OPTS = {\n        tile: 1024,\n        concurrency: concurrency,\n        features: ['js', 'wasm', 'ww'],\n        idle: 2000,\n        createCanvas: function createCanvas(width, height) {\n          var tmpCanvas = document.createElement('canvas');\n          tmpCanvas.width = width;\n          tmpCanvas.height = height;\n          return tmpCanvas;\n        }\n      };\n      var DEFAULT_RESIZE_OPTS = {\n        filter: 'mks2013',\n        unsharpAmount: 0,\n        unsharpRadius: 0.0,\n        unsharpThreshold: 0\n      };\n      var CAN_NEW_IMAGE_DATA = false;\n      var CAN_CREATE_IMAGE_BITMAP = false;\n      var CAN_USE_CANVAS_GET_IMAGE_DATA = false;\n      var CAN_USE_OFFSCREEN_CANVAS = false;\n      var CAN_USE_CIB_REGION_FOR_IMAGE = false;\n      function workerFabric() {\n        return {\n          value: webworkify(worker),\n          destroy: function destroy() {\n            this.value.terminate();\n            if (typeof window !== 'undefined') {\n              var url = window.URL || window.webkitURL || window.mozURL || window.msURL;\n              if (url && url.revokeObjectURL && this.value.objectURL) {\n                url.revokeObjectURL(this.value.objectURL);\n              }\n            }\n          }\n        };\n      } ////////////////////////////////////////////////////////////////////////////////\n      // API methods\n\n      function Pica(options) {\n        if (!(this instanceof Pica)) return new Pica(options);\n        this.options = assign({}, DEFAULT_PICA_OPTS, options || {});\n        var limiter_key = \"lk_\".concat(this.options.concurrency); // Share limiters to avoid multiple parallel workers when user creates\n        // multiple pica instances.\n\n        this.__limit = singletones[limiter_key] || utils.limiter(this.options.concurrency);\n        if (!singletones[limiter_key]) singletones[limiter_key] = this.__limit; // List of supported features, according to options & browser/node.js\n\n        this.features = {\n          js: false,\n          // pure JS implementation, can be disabled for testing\n          wasm: false,\n          // webassembly implementation for heavy functions\n          cib: false,\n          // resize via createImageBitmap (only FF at this moment)\n          ww: false // webworkers\n        };\n\n        this.__workersPool = null; // Store requested features for webworkers\n\n        this.__requested_features = [];\n        this.__mathlib = null;\n      }\n      Pica.prototype.init = function () {\n        var _this = this;\n        if (this.__initPromise) return this.__initPromise; // Test if we can create ImageData without canvas and memory copy\n\n        if (typeof ImageData !== 'undefined' && typeof Uint8ClampedArray !== 'undefined') {\n          try {\n            /* eslint-disable no-new */\n            new ImageData(new Uint8ClampedArray(400), 10, 10);\n            CAN_NEW_IMAGE_DATA = true;\n          } catch (__) {}\n        } // ImageBitmap can be effective in 2 places:\n        //\n        // 1. Threaded jpeg unpack (basic)\n        // 2. Built-in resize (blocked due problem in chrome, see issue #89)\n        //\n        // For basic use we also need ImageBitmap wo support .close() method,\n        // see https://developer.mozilla.org/ru/docs/Web/API/ImageBitmap\n\n        if (typeof ImageBitmap !== 'undefined') {\n          if (ImageBitmap.prototype && ImageBitmap.prototype.close) {\n            CAN_CREATE_IMAGE_BITMAP = true;\n          } else {\n            this.debug('ImageBitmap does not support .close(), disabled');\n          }\n        }\n        var features = this.options.features.slice();\n        if (features.indexOf('all') >= 0) {\n          features = ['cib', 'wasm', 'js', 'ww'];\n        }\n        this.__requested_features = features;\n        this.__mathlib = new MathLib(features); // Check WebWorker support if requested\n\n        if (features.indexOf('ww') >= 0) {\n          if (typeof window !== 'undefined' && 'Worker' in window) {\n            // IE <= 11 don't allow to create webworkers from string. We should check it.\n            // https://connect.microsoft.com/IE/feedback/details/801810/web-workers-from-blob-urls-in-ie-10-and-11\n            try {\n              var wkr = _dereq_('webworkify')(function () {});\n              wkr.terminate();\n              this.features.ww = true; // pool uniqueness depends on pool config + webworker config\n\n              var wpool_key = \"wp_\".concat(JSON.stringify(this.options));\n              if (singletones[wpool_key]) {\n                this.__workersPool = singletones[wpool_key];\n              } else {\n                this.__workersPool = new Pool(workerFabric, this.options.idle);\n                singletones[wpool_key] = this.__workersPool;\n              }\n            } catch (__) {}\n          }\n        }\n        var initMath = this.__mathlib.init().then(function (mathlib) {\n          // Copy detected features\n          assign(_this.features, mathlib.features);\n        });\n        var checkCibResize;\n        if (!CAN_CREATE_IMAGE_BITMAP) {\n          checkCibResize = Promise.resolve(false);\n        } else {\n          checkCibResize = utils.cib_support(this.options.createCanvas).then(function (status) {\n            if (_this.features.cib && features.indexOf('cib') < 0) {\n              _this.debug('createImageBitmap() resize supported, but disabled by config');\n              return;\n            }\n            if (features.indexOf('cib') >= 0) _this.features.cib = status;\n          });\n        }\n        CAN_USE_CANVAS_GET_IMAGE_DATA = utils.can_use_canvas(this.options.createCanvas);\n        var checkOffscreenCanvas;\n        if (CAN_CREATE_IMAGE_BITMAP && CAN_NEW_IMAGE_DATA && features.indexOf('ww') !== -1) {\n          checkOffscreenCanvas = utils.worker_offscreen_canvas_support();\n        } else {\n          checkOffscreenCanvas = Promise.resolve(false);\n        }\n        checkOffscreenCanvas = checkOffscreenCanvas.then(function (result) {\n          CAN_USE_OFFSCREEN_CANVAS = result;\n        }); // we use createImageBitmap to crop image data and pass it to workers,\n        // so need to check whether function works correctly;\n        // https://bugs.chromium.org/p/chromium/issues/detail?id=1220671\n\n        var checkCibRegion = utils.cib_can_use_region().then(function (result) {\n          CAN_USE_CIB_REGION_FOR_IMAGE = result;\n        }); // Init math lib. That's async because can load some\n\n        this.__initPromise = Promise.all([initMath, checkCibResize, checkOffscreenCanvas, checkCibRegion]).then(function () {\n          return _this;\n        });\n        return this.__initPromise;\n      }; // Call resizer in webworker or locally, depending on config\n\n      Pica.prototype.__invokeResize = function (tileOpts, opts) {\n        var _this2 = this;\n\n        // Share cache between calls:\n        //\n        // - wasm instance\n        // - wasm memory object\n        //\n        opts.__mathCache = opts.__mathCache || {};\n        return Promise.resolve().then(function () {\n          if (!_this2.features.ww) {\n            // not possible to have ImageBitmap here if user disabled WW\n            return {\n              data: _this2.__mathlib.resizeAndUnsharp(tileOpts, opts.__mathCache)\n            };\n          }\n          return new Promise(function (resolve, reject) {\n            var w = _this2.__workersPool.acquire();\n            if (opts.cancelToken) opts.cancelToken[\"catch\"](function (err) {\n              return reject(err);\n            });\n            w.value.onmessage = function (ev) {\n              w.release();\n              if (ev.data.err) reject(ev.data.err);else resolve(ev.data);\n            };\n            var transfer = [];\n            if (tileOpts.src) transfer.push(tileOpts.src.buffer);\n            if (tileOpts.srcBitmap) transfer.push(tileOpts.srcBitmap);\n            w.value.postMessage({\n              opts: tileOpts,\n              features: _this2.__requested_features,\n              preload: {\n                wasm_nodule: _this2.__mathlib.__\n              }\n            }, transfer);\n          });\n        });\n      }; // this function can return promise if createImageBitmap is used\n\n      Pica.prototype.__extractTileData = function (tile, from, opts, stageEnv, extractTo) {\n        if (this.features.ww && CAN_USE_OFFSCREEN_CANVAS && (\n        // createImageBitmap doesn't work for images (Image, ImageBitmap) with Exif orientation in Chrome,\n        // can use canvas because canvas doesn't have orientation;\n        // see https://bugs.chromium.org/p/chromium/issues/detail?id=1220671\n        utils.isCanvas(from) || CAN_USE_CIB_REGION_FOR_IMAGE)) {\n          this.debug('Create tile for OffscreenCanvas');\n          return createImageBitmap(stageEnv.srcImageBitmap || from, tile.x, tile.y, tile.width, tile.height).then(function (bitmap) {\n            extractTo.srcBitmap = bitmap;\n            return extractTo;\n          });\n        } // Extract tile RGBA buffer, depending on input type\n\n        if (utils.isCanvas(from)) {\n          if (!stageEnv.srcCtx) stageEnv.srcCtx = from.getContext('2d'); // If input is Canvas - extract region data directly\n\n          this.debug('Get tile pixel data');\n          extractTo.src = stageEnv.srcCtx.getImageData(tile.x, tile.y, tile.width, tile.height).data;\n          return extractTo;\n        } // If input is Image or decoded to ImageBitmap,\n        // draw region to temporary canvas and extract data from it\n        //\n        // Note! Attempt to reuse this canvas causes significant slowdown in chrome\n        //\n\n        this.debug('Draw tile imageBitmap/image to temporary canvas');\n        var tmpCanvas = this.options.createCanvas(tile.width, tile.height);\n        var tmpCtx = tmpCanvas.getContext('2d');\n        tmpCtx.globalCompositeOperation = 'copy';\n        tmpCtx.drawImage(stageEnv.srcImageBitmap || from, tile.x, tile.y, tile.width, tile.height, 0, 0, tile.width, tile.height);\n        this.debug('Get tile pixel data');\n        extractTo.src = tmpCtx.getImageData(0, 0, tile.width, tile.height).data; // Safari 12 workaround\n        // https://github.com/nodeca/pica/issues/199\n\n        tmpCanvas.width = tmpCanvas.height = 0;\n        return extractTo;\n      };\n      Pica.prototype.__landTileData = function (tile, result, stageEnv) {\n        var toImageData;\n        this.debug('Convert raw rgba tile result to ImageData');\n        if (result.bitmap) {\n          stageEnv.toCtx.drawImage(result.bitmap, tile.toX, tile.toY);\n          return null;\n        }\n        if (CAN_NEW_IMAGE_DATA) {\n          // this branch is for modern browsers\n          // If `new ImageData()` & Uint8ClampedArray suported\n          toImageData = new ImageData(new Uint8ClampedArray(result.data), tile.toWidth, tile.toHeight);\n        } else {\n          // fallback for `node-canvas` and old browsers\n          // (IE11 has ImageData but does not support `new ImageData()`)\n          toImageData = stageEnv.toCtx.createImageData(tile.toWidth, tile.toHeight);\n          if (toImageData.data.set) {\n            toImageData.data.set(result.data);\n          } else {\n            // IE9 don't have `.set()`\n            for (var i = toImageData.data.length - 1; i >= 0; i--) {\n              toImageData.data[i] = result.data[i];\n            }\n          }\n        }\n        this.debug('Draw tile');\n        if (NEED_SAFARI_FIX) {\n          // Safari draws thin white stripes between tiles without this fix\n          stageEnv.toCtx.putImageData(toImageData, tile.toX, tile.toY, tile.toInnerX - tile.toX, tile.toInnerY - tile.toY, tile.toInnerWidth + 1e-5, tile.toInnerHeight + 1e-5);\n        } else {\n          stageEnv.toCtx.putImageData(toImageData, tile.toX, tile.toY, tile.toInnerX - tile.toX, tile.toInnerY - tile.toY, tile.toInnerWidth, tile.toInnerHeight);\n        }\n        return null;\n      };\n      Pica.prototype.__tileAndResize = function (from, to, opts) {\n        var _this3 = this;\n        var stageEnv = {\n          srcCtx: null,\n          srcImageBitmap: null,\n          isImageBitmapReused: false,\n          toCtx: null\n        };\n        var processTile = function processTile(tile) {\n          return _this3.__limit(function () {\n            if (opts.canceled) return opts.cancelToken;\n            var tileOpts = {\n              width: tile.width,\n              height: tile.height,\n              toWidth: tile.toWidth,\n              toHeight: tile.toHeight,\n              scaleX: tile.scaleX,\n              scaleY: tile.scaleY,\n              offsetX: tile.offsetX,\n              offsetY: tile.offsetY,\n              filter: opts.filter,\n              unsharpAmount: opts.unsharpAmount,\n              unsharpRadius: opts.unsharpRadius,\n              unsharpThreshold: opts.unsharpThreshold\n            };\n            _this3.debug('Invoke resize math');\n            return Promise.resolve(tileOpts).then(function (tileOpts) {\n              return _this3.__extractTileData(tile, from, opts, stageEnv, tileOpts);\n            }).then(function (tileOpts) {\n              _this3.debug('Invoke resize math');\n              return _this3.__invokeResize(tileOpts, opts);\n            }).then(function (result) {\n              if (opts.canceled) return opts.cancelToken;\n              stageEnv.srcImageData = null;\n              return _this3.__landTileData(tile, result, stageEnv);\n            });\n          });\n        }; // Need to normalize data source first. It can be canvas or image.\n        // If image - try to decode in background if possible\n\n        return Promise.resolve().then(function () {\n          stageEnv.toCtx = to.getContext('2d');\n          if (utils.isCanvas(from)) return null;\n          if (utils.isImageBitmap(from)) {\n            stageEnv.srcImageBitmap = from;\n            stageEnv.isImageBitmapReused = true;\n            return null;\n          }\n          if (utils.isImage(from)) {\n            // try do decode image in background for faster next operations;\n            // if we're using offscreen canvas, cib is called per tile, so not needed here\n            if (!CAN_CREATE_IMAGE_BITMAP) return null;\n            _this3.debug('Decode image via createImageBitmap');\n            return createImageBitmap(from).then(function (imageBitmap) {\n              stageEnv.srcImageBitmap = imageBitmap;\n            }) // Suppress error to use fallback, if method fails\n            // https://github.com/nodeca/pica/issues/190\n\n            /* eslint-disable no-unused-vars */[\"catch\"](function (e) {\n              return null;\n            });\n          }\n          throw new Error('Pica: \".from\" should be Image, Canvas or ImageBitmap');\n        }).then(function () {\n          if (opts.canceled) return opts.cancelToken;\n          _this3.debug('Calculate tiles'); //\n          // Here we are with \"normalized\" source,\n          // follow to tiling\n          //\n\n          var regions = createRegions({\n            width: opts.width,\n            height: opts.height,\n            srcTileSize: _this3.options.tile,\n            toWidth: opts.toWidth,\n            toHeight: opts.toHeight,\n            destTileBorder: opts.__destTileBorder\n          });\n          var jobs = regions.map(function (tile) {\n            return processTile(tile);\n          });\n          function cleanup(stageEnv) {\n            if (stageEnv.srcImageBitmap) {\n              if (!stageEnv.isImageBitmapReused) stageEnv.srcImageBitmap.close();\n              stageEnv.srcImageBitmap = null;\n            }\n          }\n          _this3.debug('Process tiles');\n          return Promise.all(jobs).then(function () {\n            _this3.debug('Finished!');\n            cleanup(stageEnv);\n            return to;\n          }, function (err) {\n            cleanup(stageEnv);\n            throw err;\n          });\n        });\n      };\n      Pica.prototype.__processStages = function (stages, from, to, opts) {\n        var _this4 = this;\n        if (opts.canceled) return opts.cancelToken;\n        var _stages$shift = stages.shift(),\n          _stages$shift2 = _slicedToArray(_stages$shift, 2),\n          toWidth = _stages$shift2[0],\n          toHeight = _stages$shift2[1];\n        var isLastStage = stages.length === 0; // Optimization for legacy filters -\n        // only use user-defined quality for the last stage,\n        // use simpler (Hamming) filter for the first stages where\n        // scale factor is large enough (more than 2-3)\n        //\n        // For advanced filters (mks2013 and custom) - skip optimization,\n        // because need to apply sharpening every time\n\n        var filter;\n        if (isLastStage || filter_info.q2f.indexOf(opts.filter) < 0) filter = opts.filter;else if (opts.filter === 'box') filter = 'box';else filter = 'hamming';\n        opts = assign({}, opts, {\n          toWidth: toWidth,\n          toHeight: toHeight,\n          filter: filter\n        });\n        var tmpCanvas;\n        if (!isLastStage) {\n          // create temporary canvas\n          tmpCanvas = this.options.createCanvas(toWidth, toHeight);\n        }\n        return this.__tileAndResize(from, isLastStage ? to : tmpCanvas, opts).then(function () {\n          if (isLastStage) return to;\n          opts.width = toWidth;\n          opts.height = toHeight;\n          return _this4.__processStages(stages, tmpCanvas, to, opts);\n        }).then(function (res) {\n          if (tmpCanvas) {\n            // Safari 12 workaround\n            // https://github.com/nodeca/pica/issues/199\n            tmpCanvas.width = tmpCanvas.height = 0;\n          }\n          return res;\n        });\n      };\n      Pica.prototype.__resizeViaCreateImageBitmap = function (from, to, opts) {\n        var _this5 = this;\n        var toCtx = to.getContext('2d');\n        this.debug('Resize via createImageBitmap()');\n        return createImageBitmap(from, {\n          resizeWidth: opts.toWidth,\n          resizeHeight: opts.toHeight,\n          resizeQuality: utils.cib_quality_name(filter_info.f2q[opts.filter])\n        }).then(function (imageBitmap) {\n          if (opts.canceled) return opts.cancelToken; // if no unsharp - draw directly to output canvas\n\n          if (!opts.unsharpAmount) {\n            toCtx.drawImage(imageBitmap, 0, 0);\n            imageBitmap.close();\n            toCtx = null;\n            _this5.debug('Finished!');\n            return to;\n          }\n          _this5.debug('Unsharp result');\n          var tmpCanvas = _this5.options.createCanvas(opts.toWidth, opts.toHeight);\n          var tmpCtx = tmpCanvas.getContext('2d');\n          tmpCtx.drawImage(imageBitmap, 0, 0);\n          imageBitmap.close();\n          var iData = tmpCtx.getImageData(0, 0, opts.toWidth, opts.toHeight);\n          _this5.__mathlib.unsharp_mask(iData.data, opts.toWidth, opts.toHeight, opts.unsharpAmount, opts.unsharpRadius, opts.unsharpThreshold);\n          toCtx.putImageData(iData, 0, 0); // Safari 12 workaround\n          // https://github.com/nodeca/pica/issues/199\n\n          tmpCanvas.width = tmpCanvas.height = 0;\n          iData = tmpCtx = tmpCanvas = toCtx = null;\n          _this5.debug('Finished!');\n          return to;\n        });\n      };\n      Pica.prototype.resize = function (from, to, options) {\n        var _this6 = this;\n        this.debug('Start resize...');\n        var opts = assign({}, DEFAULT_RESIZE_OPTS);\n        if (!isNaN(options)) {\n          opts = assign(opts, {\n            quality: options\n          });\n        } else if (options) {\n          opts = assign(opts, options);\n        }\n        opts.toWidth = to.width;\n        opts.toHeight = to.height;\n        opts.width = from.naturalWidth || from.width;\n        opts.height = from.naturalHeight || from.height; // Legacy `.quality` option\n\n        if (Object.prototype.hasOwnProperty.call(opts, 'quality')) {\n          if (opts.quality < 0 || opts.quality > 3) {\n            throw new Error(\"Pica: .quality should be [0..3], got \".concat(opts.quality));\n          }\n          opts.filter = filter_info.q2f[opts.quality];\n        } // Prevent stepper from infinite loop\n\n        if (to.width === 0 || to.height === 0) {\n          return Promise.reject(new Error(\"Invalid output size: \".concat(to.width, \"x\").concat(to.height)));\n        }\n        if (opts.unsharpRadius > 2) opts.unsharpRadius = 2;\n        opts.canceled = false;\n        if (opts.cancelToken) {\n          // Wrap cancelToken to avoid successive resolve & set flag\n          opts.cancelToken = opts.cancelToken.then(function (data) {\n            opts.canceled = true;\n            throw data;\n          }, function (err) {\n            opts.canceled = true;\n            throw err;\n          });\n        }\n        var DEST_TILE_BORDER = 3; // Max possible filter window size\n\n        opts.__destTileBorder = Math.ceil(Math.max(DEST_TILE_BORDER, 2.5 * opts.unsharpRadius | 0));\n        return this.init().then(function () {\n          if (opts.canceled) return opts.cancelToken; // if createImageBitmap supports resize, just do it and return\n\n          if (_this6.features.cib) {\n            if (filter_info.q2f.indexOf(opts.filter) >= 0) {\n              return _this6.__resizeViaCreateImageBitmap(from, to, opts);\n            }\n            _this6.debug('cib is enabled, but not supports provided filter, fallback to manual math');\n          }\n          if (!CAN_USE_CANVAS_GET_IMAGE_DATA) {\n            var err = new Error('Pica: cannot use getImageData on canvas, ' + \"make sure fingerprinting protection isn't enabled\");\n            err.code = 'ERR_GET_IMAGE_DATA';\n            throw err;\n          } //\n          // No easy way, let's resize manually via arrays\n          //\n\n          var stages = createStages(opts.width, opts.height, opts.toWidth, opts.toHeight, _this6.options.tile, opts.__destTileBorder);\n          return _this6.__processStages(stages, from, to, opts);\n        });\n      }; // RGBA buffer resize\n      //\n\n      Pica.prototype.resizeBuffer = function (options) {\n        var _this7 = this;\n        var opts = assign({}, DEFAULT_RESIZE_OPTS, options); // Legacy `.quality` option\n\n        if (Object.prototype.hasOwnProperty.call(opts, 'quality')) {\n          if (opts.quality < 0 || opts.quality > 3) {\n            throw new Error(\"Pica: .quality should be [0..3], got \".concat(opts.quality));\n          }\n          opts.filter = filter_info.q2f[opts.quality];\n        }\n        return this.init().then(function () {\n          return _this7.__mathlib.resizeAndUnsharp(opts);\n        });\n      };\n      Pica.prototype.toBlob = function (canvas, mimeType, quality) {\n        mimeType = mimeType || 'image/png';\n        return new Promise(function (resolve) {\n          if (canvas.toBlob) {\n            canvas.toBlob(function (blob) {\n              return resolve(blob);\n            }, mimeType, quality);\n            return;\n          }\n          if (canvas.convertToBlob) {\n            resolve(canvas.convertToBlob({\n              type: mimeType,\n              quality: quality\n            }));\n            return;\n          } // Fallback for old browsers\n\n          var asString = atob(canvas.toDataURL(mimeType, quality).split(',')[1]);\n          var len = asString.length;\n          var asBuffer = new Uint8Array(len);\n          for (var i = 0; i < len; i++) {\n            asBuffer[i] = asString.charCodeAt(i);\n          }\n          resolve(new Blob([asBuffer], {\n            type: mimeType\n          }));\n        });\n      };\n      Pica.prototype.debug = function () {};\n      module.exports = Pica;\n    }, {\n      \"./lib/mathlib\": 1,\n      \"./lib/mm_resize/resize_filter_info\": 7,\n      \"./lib/pool\": 13,\n      \"./lib/stepper\": 14,\n      \"./lib/tiler\": 15,\n      \"./lib/utils\": 16,\n      \"./lib/worker\": 17,\n      \"object-assign\": 22,\n      \"webworkify\": 23\n    }]\n  }, {}, [])(\"/index.js\");\n});","map":{"version":3,"names":["f","exports","module","define","amd","g","window","global","self","pica","r","e","n","t","o","i","c","require","u","a","Error","code","p","call","length","_dereq_","Multimath","mm_unsharp_mask","mm_resize","MathLib","requested_features","__requested_features","features","js","indexOf","wasm","has_wasm","use","prototype","Object","create","constructor","resizeAndUnsharp","options","cache","result","resize","unsharpAmount","unsharp_mask","toWidth","toHeight","unsharpRadius","unsharpThreshold","clampTo8","clampNegative","convolveHor","src","dest","srcW","srcH","destW","filters","b","filterPtr","filterShift","filterSize","srcPtr","srcY","destX","filterVal","srcOffset","destOffset","convolveVert","convolveHorWithPre","alpha","convolveVertWithPre","name","fn","wasm_fn","wasm_src","createFilters","_require","hasAlpha","width","height","ptr","len","resetAlpha","dst","destH","scaleX","scaleY","offsetX","offsetY","Uint8Array","filter","filtersX","filtersY","tmp","Uint16Array","FILTER_INFO","FIXED_FRAC_BITS","toFixedPoint","num","Math","round","resizeFilterGen","srcSize","destSize","scale","offset","filterFunction","scaleInverted","scaleClamped","min","srcWindow","win","destPixel","srcPixel","srcFirst","srcLast","filterElementSize","floatFilter","fxpFilter","total","pxl","idx","floatVal","filterTotal","leftNotEmpty","rightNotEmpty","maxFilterElementSize","floor","packedFilter","Int16Array","packedFilterPtr","slowCopy","subarray","set","max","ceil","Float32Array","box","x","hamming","xpi","PI","sin","cos","lanczos2","lanczos3","mks2013","f2q","q2f","asUint8Array","buffer","byteLength","IS_LE","Uint32Array","__","copyInt16asLE","target","target_offset","data","resize_wasm","src_offset","src_size","tmp_offset","__align","tmp_size","filtersX_offset","filtersY_offset","alloc_bytes","instance","__instance","mem","__memory","mem32","src32","convolveHV","_convolveHV","dest32","glur_mono16","hsv_v16","img","size","out","unsharp","amount","radius","threshold","v1","v2","vmul","diff","iTimes4","brightness","blured","amountFp","thresholdFp","abs","pixels","img_bytes_cnt","hsv_bytes_cnt","blur_bytes_cnt","blur_line_byte_cnt","blur_coeffs_byte_cnt","img_offset","hsv_offset","blur_offset","blur_tmp_offset","blur_line_offset","blur_coeffs_offset","exp","img32","_hsv_v16","blurMono16","_blurMono16","_unsharp","GC_INTERVAL","Pool","idle","available","acquired","lastId","timeoutId","acquire","_this","resource","pop","id","release","_this2","lastUsed","Date","now","push","setTimeout","gc","_this3","destroy","MIN_INNER_TILE_SIZE","createStages","fromWidth","fromHeight","srcTileSize","destTileBorder","minScale","stageCount","log","pow","PIXEL_EPSILON","pixelFloor","nearest","pixelCeil","createRegions","innerTileWidth","innerTileHeight","y","innerX","innerY","toTileWidth","toTileHeight","tiles","tile","toX","toY","toInnerX","toInnerY","toInnerWidth","toInnerHeight","objClass","obj","toString","isCanvas","element","cname","isImage","isImageBitmap","limiter","concurrency","active","queue","roll","shift","limit","Promise","resolve","reject","then","err","cib_quality_name","cib_support","createCanvas","createImageBitmap","resizeWidth","resizeHeight","resizeQuality","bitmap","status","close","worker_offscreen_canvas_support","OffscreenCanvas","workerPayload","postMessage","canvas","ctx","getContext","rect","btoa","concat","w","Worker","onmessage","ev","onerror","can_use_canvas","usable","d","createImageData","putImageData","getImageData","cib_can_use_region","Image","image","onload","mathLib","tileOpts","opts","returnBitmap","srcBitmap","drawImage","toImageData","ImageData","Uint8ClampedArray","_canvas","_ctx","a0","a1","a2","a3","b1","b2","left_corner","right_corner","gaussCoef","sigma","g1","g2","k","convolveMono16","line","coeff","prev_src","curr_src","curr_out","prev_out","prev_prev_out","src_index","out_index","line_index","j","coeff_a0","coeff_a1","coeff_b1","coeff_b2","tmp_line","assign","base64decode","hasWebAssembly","DEFAULT_OPTIONS","MultiMath","__cache","__init_promise","__modules","modules","__wasm","__isLE","init","all","keys","map","WebAssembly","compile","__base64decode","m","__reallocate","mem_grow_to","bytes","Memory","initial","mem_size","grow","memsize","env_extra","Module","env_base","memoryBase","memory","tableBase","table","Table","Instance","env","align","number","base","reminder","BASE64_MAP","str","input","replace","bits","charAt","tailbits","wa","bin","test","getOwnPropertySymbols","hasOwnProperty","propIsEnumerable","propertyIsEnumerable","toObject","val","undefined","TypeError","shouldUseNative","test1","String","getOwnPropertyNames","test2","fromCharCode","order2","join","test3","split","forEach","letter","source","from","to","symbols","s","arguments","key","bundleFn","sources","stringify","JSON","wkey","cacheKeys","l","default","random","wcache","skey","scache","workerSources","resolveSources","depPath","depKey","URL","webkitURL","mozURL","msURL","blob","Blob","type","bare","workerUrl","createObjectURL","worker","objectURL","_slicedToArray","arr","_arrayWithHoles","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","minLen","_arrayLikeToArray","slice","Array","arr2","_i","Symbol","iterator","_arr","_n","_d","_s","_e","next","done","value","isArray","webworkify","utils","filter_info","singletones","NEED_SAFARI_FIX","navigator","userAgent","hardwareConcurrency","DEFAULT_PICA_OPTS","tmpCanvas","document","createElement","DEFAULT_RESIZE_OPTS","CAN_NEW_IMAGE_DATA","CAN_CREATE_IMAGE_BITMAP","CAN_USE_CANVAS_GET_IMAGE_DATA","CAN_USE_OFFSCREEN_CANVAS","CAN_USE_CIB_REGION_FOR_IMAGE","workerFabric","terminate","url","revokeObjectURL","Pica","limiter_key","__limit","cib","ww","__workersPool","__mathlib","__initPromise","ImageBitmap","debug","wkr","wpool_key","initMath","mathlib","checkCibResize","checkOffscreenCanvas","checkCibRegion","__invokeResize","__mathCache","cancelToken","transfer","preload","wasm_nodule","__extractTileData","stageEnv","extractTo","srcImageBitmap","srcCtx","tmpCtx","globalCompositeOperation","__landTileData","toCtx","__tileAndResize","isImageBitmapReused","processTile","canceled","srcImageData","imageBitmap","regions","__destTileBorder","jobs","cleanup","__processStages","stages","_this4","_stages$shift","_stages$shift2","isLastStage","res","__resizeViaCreateImageBitmap","_this5","iData","_this6","isNaN","quality","naturalWidth","naturalHeight","DEST_TILE_BORDER","resizeBuffer","_this7","toBlob","mimeType","convertToBlob","asString","atob","toDataURL","asBuffer","charCodeAt"],"sources":["C:/Users/jadep/Desktop/diary2/diary2/client/node_modules/pica/dist/pica.js"],"sourcesContent":["/*!\n\npica\nhttps://github.com/nodeca/pica\n\n*/\n\n(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.pica = f()}})(function(){var define,module,exports;return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(_dereq_,module,exports){\n// Collection of math functions\n//\n// 1. Combine components together\n// 2. Has async init to load wasm modules\n//\n'use strict';\n\nvar Multimath = _dereq_('multimath');\n\nvar mm_unsharp_mask = _dereq_('./mm_unsharp_mask');\n\nvar mm_resize = _dereq_('./mm_resize');\n\nfunction MathLib(requested_features) {\n  var __requested_features = requested_features || [];\n\n  var features = {\n    js: __requested_features.indexOf('js') >= 0,\n    wasm: __requested_features.indexOf('wasm') >= 0\n  };\n  Multimath.call(this, features);\n  this.features = {\n    js: features.js,\n    wasm: features.wasm && this.has_wasm()\n  };\n  this.use(mm_unsharp_mask);\n  this.use(mm_resize);\n}\n\nMathLib.prototype = Object.create(Multimath.prototype);\nMathLib.prototype.constructor = MathLib;\n\nMathLib.prototype.resizeAndUnsharp = function resizeAndUnsharp(options, cache) {\n  var result = this.resize(options, cache);\n\n  if (options.unsharpAmount) {\n    this.unsharp_mask(result, options.toWidth, options.toHeight, options.unsharpAmount, options.unsharpRadius, options.unsharpThreshold);\n  }\n\n  return result;\n};\n\nmodule.exports = MathLib;\n\n},{\"./mm_resize\":4,\"./mm_unsharp_mask\":9,\"multimath\":19}],2:[function(_dereq_,module,exports){\n// Resize convolvers, pure JS implementation\n//\n'use strict'; // Precision of fixed FP values\n//var FIXED_FRAC_BITS = 14;\n\nfunction clampTo8(i) {\n  return i < 0 ? 0 : i > 255 ? 255 : i;\n}\n\nfunction clampNegative(i) {\n  return i >= 0 ? i : 0;\n} // Convolve image data in horizontal direction. Can be used for:\n//\n// 1. bitmap with premultiplied alpha\n// 2. bitmap without alpha (all values 255)\n//\n// Notes:\n//\n// - output is transposed\n// - output resolution is ~15 bits per channel(for better precision).\n//\n\n\nfunction convolveHor(src, dest, srcW, srcH, destW, filters) {\n  var r, g, b, a;\n  var filterPtr, filterShift, filterSize;\n  var srcPtr, srcY, destX, filterVal;\n  var srcOffset = 0,\n      destOffset = 0; // For each row\n\n  for (srcY = 0; srcY < srcH; srcY++) {\n    filterPtr = 0; // Apply precomputed filters to each destination row point\n\n    for (destX = 0; destX < destW; destX++) {\n      // Get the filter that determines the current output pixel.\n      filterShift = filters[filterPtr++];\n      filterSize = filters[filterPtr++];\n      srcPtr = srcOffset + filterShift * 4 | 0;\n      r = g = b = a = 0; // Apply the filter to the row to get the destination pixel r, g, b, a\n\n      for (; filterSize > 0; filterSize--) {\n        filterVal = filters[filterPtr++]; // Use reverse order to workaround deopts in old v8 (node v.10)\n        // Big thanks to @mraleph (Vyacheslav Egorov) for the tip.\n\n        a = a + filterVal * src[srcPtr + 3] | 0;\n        b = b + filterVal * src[srcPtr + 2] | 0;\n        g = g + filterVal * src[srcPtr + 1] | 0;\n        r = r + filterVal * src[srcPtr] | 0;\n        srcPtr = srcPtr + 4 | 0;\n      } // Store 15 bits between passes for better precision\n      // Instead of shift to 14 (FIXED_FRAC_BITS), shift to 7 only\n      //\n\n\n      dest[destOffset + 3] = clampNegative(a >> 7);\n      dest[destOffset + 2] = clampNegative(b >> 7);\n      dest[destOffset + 1] = clampNegative(g >> 7);\n      dest[destOffset] = clampNegative(r >> 7);\n      destOffset = destOffset + srcH * 4 | 0;\n    }\n\n    destOffset = (srcY + 1) * 4 | 0;\n    srcOffset = (srcY + 1) * srcW * 4 | 0;\n  }\n} // Supplementary method for `convolveHor()`\n//\n\n\nfunction convolveVert(src, dest, srcW, srcH, destW, filters) {\n  var r, g, b, a;\n  var filterPtr, filterShift, filterSize;\n  var srcPtr, srcY, destX, filterVal;\n  var srcOffset = 0,\n      destOffset = 0; // For each row\n\n  for (srcY = 0; srcY < srcH; srcY++) {\n    filterPtr = 0; // Apply precomputed filters to each destination row point\n\n    for (destX = 0; destX < destW; destX++) {\n      // Get the filter that determines the current output pixel.\n      filterShift = filters[filterPtr++];\n      filterSize = filters[filterPtr++];\n      srcPtr = srcOffset + filterShift * 4 | 0;\n      r = g = b = a = 0; // Apply the filter to the row to get the destination pixel r, g, b, a\n\n      for (; filterSize > 0; filterSize--) {\n        filterVal = filters[filterPtr++]; // Use reverse order to workaround deopts in old v8 (node v.10)\n        // Big thanks to @mraleph (Vyacheslav Egorov) for the tip.\n\n        a = a + filterVal * src[srcPtr + 3] | 0;\n        b = b + filterVal * src[srcPtr + 2] | 0;\n        g = g + filterVal * src[srcPtr + 1] | 0;\n        r = r + filterVal * src[srcPtr] | 0;\n        srcPtr = srcPtr + 4 | 0;\n      } // Sync with premultiplied version for exact result match\n\n\n      r >>= 7;\n      g >>= 7;\n      b >>= 7;\n      a >>= 7; // Bring this value back in range + round result.\n      //\n\n      dest[destOffset + 3] = clampTo8(a + (1 << 13) >> 14);\n      dest[destOffset + 2] = clampTo8(b + (1 << 13) >> 14);\n      dest[destOffset + 1] = clampTo8(g + (1 << 13) >> 14);\n      dest[destOffset] = clampTo8(r + (1 << 13) >> 14);\n      destOffset = destOffset + srcH * 4 | 0;\n    }\n\n    destOffset = (srcY + 1) * 4 | 0;\n    srcOffset = (srcY + 1) * srcW * 4 | 0;\n  }\n} // Premultiply & convolve image data in horizontal direction. Can be used for:\n//\n// - Any bitmap data, extracted with `.getImageData()` method (with\n//   non-premultiplied alpha)\n//\n// For images without alpha channel this method is slower than `convolveHor()`\n//\n\n\nfunction convolveHorWithPre(src, dest, srcW, srcH, destW, filters) {\n  var r, g, b, a, alpha;\n  var filterPtr, filterShift, filterSize;\n  var srcPtr, srcY, destX, filterVal;\n  var srcOffset = 0,\n      destOffset = 0; // For each row\n\n  for (srcY = 0; srcY < srcH; srcY++) {\n    filterPtr = 0; // Apply precomputed filters to each destination row point\n\n    for (destX = 0; destX < destW; destX++) {\n      // Get the filter that determines the current output pixel.\n      filterShift = filters[filterPtr++];\n      filterSize = filters[filterPtr++];\n      srcPtr = srcOffset + filterShift * 4 | 0;\n      r = g = b = a = 0; // Apply the filter to the row to get the destination pixel r, g, b, a\n\n      for (; filterSize > 0; filterSize--) {\n        filterVal = filters[filterPtr++]; // Use reverse order to workaround deopts in old v8 (node v.10)\n        // Big thanks to @mraleph (Vyacheslav Egorov) for the tip.\n\n        alpha = src[srcPtr + 3];\n        a = a + filterVal * alpha | 0;\n        b = b + filterVal * src[srcPtr + 2] * alpha | 0;\n        g = g + filterVal * src[srcPtr + 1] * alpha | 0;\n        r = r + filterVal * src[srcPtr] * alpha | 0;\n        srcPtr = srcPtr + 4 | 0;\n      } // Premultiply is (* alpha / 255).\n      // Postpone division for better performance\n\n\n      b = b / 255 | 0;\n      g = g / 255 | 0;\n      r = r / 255 | 0; // Store 15 bits between passes for better precision\n      // Instead of shift to 14 (FIXED_FRAC_BITS), shift to 7 only\n      //\n\n      dest[destOffset + 3] = clampNegative(a >> 7);\n      dest[destOffset + 2] = clampNegative(b >> 7);\n      dest[destOffset + 1] = clampNegative(g >> 7);\n      dest[destOffset] = clampNegative(r >> 7);\n      destOffset = destOffset + srcH * 4 | 0;\n    }\n\n    destOffset = (srcY + 1) * 4 | 0;\n    srcOffset = (srcY + 1) * srcW * 4 | 0;\n  }\n} // Supplementary method for `convolveHorWithPre()`\n//\n\n\nfunction convolveVertWithPre(src, dest, srcW, srcH, destW, filters) {\n  var r, g, b, a;\n  var filterPtr, filterShift, filterSize;\n  var srcPtr, srcY, destX, filterVal;\n  var srcOffset = 0,\n      destOffset = 0; // For each row\n\n  for (srcY = 0; srcY < srcH; srcY++) {\n    filterPtr = 0; // Apply precomputed filters to each destination row point\n\n    for (destX = 0; destX < destW; destX++) {\n      // Get the filter that determines the current output pixel.\n      filterShift = filters[filterPtr++];\n      filterSize = filters[filterPtr++];\n      srcPtr = srcOffset + filterShift * 4 | 0;\n      r = g = b = a = 0; // Apply the filter to the row to get the destination pixel r, g, b, a\n\n      for (; filterSize > 0; filterSize--) {\n        filterVal = filters[filterPtr++]; // Use reverse order to workaround deopts in old v8 (node v.10)\n        // Big thanks to @mraleph (Vyacheslav Egorov) for the tip.\n\n        a = a + filterVal * src[srcPtr + 3] | 0;\n        b = b + filterVal * src[srcPtr + 2] | 0;\n        g = g + filterVal * src[srcPtr + 1] | 0;\n        r = r + filterVal * src[srcPtr] | 0;\n        srcPtr = srcPtr + 4 | 0;\n      } // Downscale to leave room for un-premultiply\n\n\n      r >>= 7;\n      g >>= 7;\n      b >>= 7;\n      a >>= 7; // Un-premultiply\n\n      a = clampTo8(a + (1 << 13) >> 14);\n\n      if (a > 0) {\n        r = r * 255 / a | 0;\n        g = g * 255 / a | 0;\n        b = b * 255 / a | 0;\n      } // Bring this value back in range + round result.\n      // Shift value = FIXED_FRAC_BITS + 7\n      //\n\n\n      dest[destOffset + 3] = a;\n      dest[destOffset + 2] = clampTo8(b + (1 << 13) >> 14);\n      dest[destOffset + 1] = clampTo8(g + (1 << 13) >> 14);\n      dest[destOffset] = clampTo8(r + (1 << 13) >> 14);\n      destOffset = destOffset + srcH * 4 | 0;\n    }\n\n    destOffset = (srcY + 1) * 4 | 0;\n    srcOffset = (srcY + 1) * srcW * 4 | 0;\n  }\n}\n\nmodule.exports = {\n  convolveHor: convolveHor,\n  convolveVert: convolveVert,\n  convolveHorWithPre: convolveHorWithPre,\n  convolveVertWithPre: convolveVertWithPre\n};\n\n},{}],3:[function(_dereq_,module,exports){\n// This is autogenerated file from math.wasm, don't edit.\n//\n'use strict';\n/* eslint-disable max-len */\n\nmodule.exports = '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';\n\n},{}],4:[function(_dereq_,module,exports){\n'use strict';\n\nmodule.exports = {\n  name: 'resize',\n  fn: _dereq_('./resize'),\n  wasm_fn: _dereq_('./resize_wasm'),\n  wasm_src: _dereq_('./convolve_wasm_base64')\n};\n\n},{\"./convolve_wasm_base64\":3,\"./resize\":5,\"./resize_wasm\":8}],5:[function(_dereq_,module,exports){\n'use strict';\n\nvar createFilters = _dereq_('./resize_filter_gen');\n\nvar _require = _dereq_('./convolve'),\n    convolveHor = _require.convolveHor,\n    convolveVert = _require.convolveVert,\n    convolveHorWithPre = _require.convolveHorWithPre,\n    convolveVertWithPre = _require.convolveVertWithPre;\n\nfunction hasAlpha(src, width, height) {\n  var ptr = 3,\n      len = width * height * 4 | 0;\n\n  while (ptr < len) {\n    if (src[ptr] !== 255) return true;\n    ptr = ptr + 4 | 0;\n  }\n\n  return false;\n}\n\nfunction resetAlpha(dst, width, height) {\n  var ptr = 3,\n      len = width * height * 4 | 0;\n\n  while (ptr < len) {\n    dst[ptr] = 0xFF;\n    ptr = ptr + 4 | 0;\n  }\n}\n\nmodule.exports = function resize(options) {\n  var src = options.src;\n  var srcW = options.width;\n  var srcH = options.height;\n  var destW = options.toWidth;\n  var destH = options.toHeight;\n  var scaleX = options.scaleX || options.toWidth / options.width;\n  var scaleY = options.scaleY || options.toHeight / options.height;\n  var offsetX = options.offsetX || 0;\n  var offsetY = options.offsetY || 0;\n  var dest = options.dest || new Uint8Array(destW * destH * 4);\n  var filter = typeof options.filter === 'undefined' ? 'mks2013' : options.filter;\n  var filtersX = createFilters(filter, srcW, destW, scaleX, offsetX),\n      filtersY = createFilters(filter, srcH, destH, scaleY, offsetY);\n  var tmp = new Uint16Array(destW * srcH * 4); // Autodetect if alpha channel exists, and use appropriate method\n\n  if (hasAlpha(src, srcW, srcH)) {\n    convolveHorWithPre(src, tmp, srcW, srcH, destW, filtersX);\n    convolveVertWithPre(tmp, dest, srcH, destW, destH, filtersY);\n  } else {\n    convolveHor(src, tmp, srcW, srcH, destW, filtersX);\n    convolveVert(tmp, dest, srcH, destW, destH, filtersY);\n    resetAlpha(dest, destW, destH);\n  }\n\n  return dest;\n};\n\n},{\"./convolve\":2,\"./resize_filter_gen\":6}],6:[function(_dereq_,module,exports){\n// Calculate convolution filters for each destination point,\n// and pack data to Int16Array:\n//\n// [ shift, length, data..., shift2, length2, data..., ... ]\n//\n// - shift - offset in src image\n// - length - filter length (in src points)\n// - data - filter values sequence\n//\n'use strict';\n\nvar FILTER_INFO = _dereq_('./resize_filter_info'); // Precision of fixed FP values\n\n\nvar FIXED_FRAC_BITS = 14;\n\nfunction toFixedPoint(num) {\n  return Math.round(num * ((1 << FIXED_FRAC_BITS) - 1));\n}\n\nmodule.exports = function resizeFilterGen(filter, srcSize, destSize, scale, offset) {\n  var filterFunction = FILTER_INFO.filter[filter].fn;\n  var scaleInverted = 1.0 / scale;\n  var scaleClamped = Math.min(1.0, scale); // For upscale\n  // Filter window (averaging interval), scaled to src image\n\n  var srcWindow = FILTER_INFO.filter[filter].win / scaleClamped;\n  var destPixel, srcPixel, srcFirst, srcLast, filterElementSize, floatFilter, fxpFilter, total, pxl, idx, floatVal, filterTotal, filterVal;\n  var leftNotEmpty, rightNotEmpty, filterShift, filterSize;\n  var maxFilterElementSize = Math.floor((srcWindow + 1) * 2);\n  var packedFilter = new Int16Array((maxFilterElementSize + 2) * destSize);\n  var packedFilterPtr = 0;\n  var slowCopy = !packedFilter.subarray || !packedFilter.set; // For each destination pixel calculate source range and built filter values\n\n  for (destPixel = 0; destPixel < destSize; destPixel++) {\n    // Scaling should be done relative to central pixel point\n    srcPixel = (destPixel + 0.5) * scaleInverted + offset;\n    srcFirst = Math.max(0, Math.floor(srcPixel - srcWindow));\n    srcLast = Math.min(srcSize - 1, Math.ceil(srcPixel + srcWindow));\n    filterElementSize = srcLast - srcFirst + 1;\n    floatFilter = new Float32Array(filterElementSize);\n    fxpFilter = new Int16Array(filterElementSize);\n    total = 0.0; // Fill filter values for calculated range\n\n    for (pxl = srcFirst, idx = 0; pxl <= srcLast; pxl++, idx++) {\n      floatVal = filterFunction((pxl + 0.5 - srcPixel) * scaleClamped);\n      total += floatVal;\n      floatFilter[idx] = floatVal;\n    } // Normalize filter, convert to fixed point and accumulate conversion error\n\n\n    filterTotal = 0;\n\n    for (idx = 0; idx < floatFilter.length; idx++) {\n      filterVal = floatFilter[idx] / total;\n      filterTotal += filterVal;\n      fxpFilter[idx] = toFixedPoint(filterVal);\n    } // Compensate normalization error, to minimize brightness drift\n\n\n    fxpFilter[destSize >> 1] += toFixedPoint(1.0 - filterTotal); //\n    // Now pack filter to useable form\n    //\n    // 1. Trim heading and tailing zero values, and compensate shitf/length\n    // 2. Put all to single array in this format:\n    //\n    //    [ pos shift, data length, value1, value2, value3, ... ]\n    //\n\n    leftNotEmpty = 0;\n\n    while (leftNotEmpty < fxpFilter.length && fxpFilter[leftNotEmpty] === 0) {\n      leftNotEmpty++;\n    }\n\n    if (leftNotEmpty < fxpFilter.length) {\n      rightNotEmpty = fxpFilter.length - 1;\n\n      while (rightNotEmpty > 0 && fxpFilter[rightNotEmpty] === 0) {\n        rightNotEmpty--;\n      }\n\n      filterShift = srcFirst + leftNotEmpty;\n      filterSize = rightNotEmpty - leftNotEmpty + 1;\n      packedFilter[packedFilterPtr++] = filterShift; // shift\n\n      packedFilter[packedFilterPtr++] = filterSize; // size\n\n      if (!slowCopy) {\n        packedFilter.set(fxpFilter.subarray(leftNotEmpty, rightNotEmpty + 1), packedFilterPtr);\n        packedFilterPtr += filterSize;\n      } else {\n        // fallback for old IE < 11, without subarray/set methods\n        for (idx = leftNotEmpty; idx <= rightNotEmpty; idx++) {\n          packedFilter[packedFilterPtr++] = fxpFilter[idx];\n        }\n      }\n    } else {\n      // zero data, write header only\n      packedFilter[packedFilterPtr++] = 0; // shift\n\n      packedFilter[packedFilterPtr++] = 0; // size\n    }\n  }\n\n  return packedFilter;\n};\n\n},{\"./resize_filter_info\":7}],7:[function(_dereq_,module,exports){\n// Filter definitions to build tables for\n// resizing convolvers.\n//\n// Presets for quality 0..3. Filter functions + window size\n//\n'use strict';\n\nvar filter = {\n  // Nearest neibor\n  box: {\n    win: 0.5,\n    fn: function fn(x) {\n      if (x < 0) x = -x;\n      return x < 0.5 ? 1.0 : 0.0;\n    }\n  },\n  // // Hamming\n  hamming: {\n    win: 1.0,\n    fn: function fn(x) {\n      if (x < 0) x = -x;\n\n      if (x >= 1.0) {\n        return 0.0;\n      }\n\n      if (x < 1.19209290E-07) {\n        return 1.0;\n      }\n\n      var xpi = x * Math.PI;\n      return Math.sin(xpi) / xpi * (0.54 + 0.46 * Math.cos(xpi / 1.0));\n    }\n  },\n  // Lanczos, win = 2\n  lanczos2: {\n    win: 2.0,\n    fn: function fn(x) {\n      if (x < 0) x = -x;\n\n      if (x >= 2.0) {\n        return 0.0;\n      }\n\n      if (x < 1.19209290E-07) {\n        return 1.0;\n      }\n\n      var xpi = x * Math.PI;\n      return Math.sin(xpi) / xpi * Math.sin(xpi / 2.0) / (xpi / 2.0);\n    }\n  },\n  // Lanczos, win = 3\n  lanczos3: {\n    win: 3.0,\n    fn: function fn(x) {\n      if (x < 0) x = -x;\n\n      if (x >= 3.0) {\n        return 0.0;\n      }\n\n      if (x < 1.19209290E-07) {\n        return 1.0;\n      }\n\n      var xpi = x * Math.PI;\n      return Math.sin(xpi) / xpi * Math.sin(xpi / 3.0) / (xpi / 3.0);\n    }\n  },\n  // Magic Kernel Sharp 2013, win = 2.5\n  // http://johncostella.com/magic/\n  mks2013: {\n    win: 2.5,\n    fn: function fn(x) {\n      if (x < 0) x = -x;\n\n      if (x >= 2.5) {\n        return 0.0;\n      }\n\n      if (x >= 1.5) {\n        return -0.125 * (x - 2.5) * (x - 2.5);\n      }\n\n      if (x >= 0.5) {\n        return 0.25 * (4 * x * x - 11 * x + 7);\n      }\n\n      return 1.0625 - 1.75 * x * x;\n    }\n  }\n};\nmodule.exports = {\n  filter: filter,\n  // Legacy mapping\n  f2q: {\n    box: 0,\n    hamming: 1,\n    lanczos2: 2,\n    lanczos3: 3\n  },\n  q2f: ['box', 'hamming', 'lanczos2', 'lanczos3']\n};\n\n},{}],8:[function(_dereq_,module,exports){\n'use strict';\n\nvar createFilters = _dereq_('./resize_filter_gen');\n\nfunction hasAlpha(src, width, height) {\n  var ptr = 3,\n      len = width * height * 4 | 0;\n\n  while (ptr < len) {\n    if (src[ptr] !== 255) return true;\n    ptr = ptr + 4 | 0;\n  }\n\n  return false;\n}\n\nfunction resetAlpha(dst, width, height) {\n  var ptr = 3,\n      len = width * height * 4 | 0;\n\n  while (ptr < len) {\n    dst[ptr] = 0xFF;\n    ptr = ptr + 4 | 0;\n  }\n}\n\nfunction asUint8Array(src) {\n  return new Uint8Array(src.buffer, 0, src.byteLength);\n}\n\nvar IS_LE = true; // should not crash everything on module load in old browsers\n\ntry {\n  IS_LE = new Uint32Array(new Uint8Array([1, 0, 0, 0]).buffer)[0] === 1;\n} catch (__) {}\n\nfunction copyInt16asLE(src, target, target_offset) {\n  if (IS_LE) {\n    target.set(asUint8Array(src), target_offset);\n    return;\n  }\n\n  for (var ptr = target_offset, i = 0; i < src.length; i++) {\n    var data = src[i];\n    target[ptr++] = data & 0xFF;\n    target[ptr++] = data >> 8 & 0xFF;\n  }\n}\n\nmodule.exports = function resize_wasm(options) {\n  var src = options.src;\n  var srcW = options.width;\n  var srcH = options.height;\n  var destW = options.toWidth;\n  var destH = options.toHeight;\n  var scaleX = options.scaleX || options.toWidth / options.width;\n  var scaleY = options.scaleY || options.toHeight / options.height;\n  var offsetX = options.offsetX || 0.0;\n  var offsetY = options.offsetY || 0.0;\n  var dest = options.dest || new Uint8Array(destW * destH * 4);\n  var filter = typeof options.filter === 'undefined' ? 'mks2013' : options.filter;\n  var filtersX = createFilters(filter, srcW, destW, scaleX, offsetX),\n      filtersY = createFilters(filter, srcH, destH, scaleY, offsetY); // destination is 0 too.\n\n  var src_offset = 0;\n  var src_size = Math.max(src.byteLength, dest.byteLength); // buffer between convolve passes\n\n  var tmp_offset = this.__align(src_offset + src_size);\n\n  var tmp_size = srcH * destW * 4 * 2; // 2 bytes per channel\n\n  var filtersX_offset = this.__align(tmp_offset + tmp_size);\n\n  var filtersY_offset = this.__align(filtersX_offset + filtersX.byteLength);\n\n  var alloc_bytes = filtersY_offset + filtersY.byteLength;\n\n  var instance = this.__instance('resize', alloc_bytes); //\n  // Fill memory block with data to process\n  //\n\n\n  var mem = new Uint8Array(this.__memory.buffer);\n  var mem32 = new Uint32Array(this.__memory.buffer); // 32-bit copy is much faster in chrome\n\n  var src32 = new Uint32Array(src.buffer);\n  mem32.set(src32); // We should guarantee LE bytes order. Filters are not big, so\n  // speed difference is not significant vs direct .set()\n\n  copyInt16asLE(filtersX, mem, filtersX_offset);\n  copyInt16asLE(filtersY, mem, filtersY_offset); // Now call webassembly method\n  // emsdk does method names with '_'\n\n  var fn = instance.exports.convolveHV || instance.exports._convolveHV;\n\n  if (hasAlpha(src, srcW, srcH)) {\n    fn(filtersX_offset, filtersY_offset, tmp_offset, srcW, srcH, destW, destH, 1);\n  } else {\n    fn(filtersX_offset, filtersY_offset, tmp_offset, srcW, srcH, destW, destH, 0);\n    resetAlpha(dest, destW, destH);\n  } //\n  // Copy data back to typed array\n  //\n  // 32-bit copy is much faster in chrome\n\n\n  var dest32 = new Uint32Array(dest.buffer);\n  dest32.set(new Uint32Array(this.__memory.buffer, 0, destH * destW));\n  return dest;\n};\n\n},{\"./resize_filter_gen\":6}],9:[function(_dereq_,module,exports){\n'use strict';\n\nmodule.exports = {\n  name: 'unsharp_mask',\n  fn: _dereq_('./unsharp_mask'),\n  wasm_fn: _dereq_('./unsharp_mask_wasm'),\n  wasm_src: _dereq_('./unsharp_mask_wasm_base64')\n};\n\n},{\"./unsharp_mask\":10,\"./unsharp_mask_wasm\":11,\"./unsharp_mask_wasm_base64\":12}],10:[function(_dereq_,module,exports){\n// Unsharp mask filter\n//\n// http://stackoverflow.com/a/23322820/1031804\n// USM(O) = O + (2 * (Amount / 100) * (O - GB))\n// GB - gaussian blur.\n//\n// Image is converted from RGB to HSV, unsharp mask is applied to the\n// brightness channel and then image is converted back to RGB.\n//\n'use strict';\n\nvar glur_mono16 = _dereq_('glur/mono16');\n\nfunction hsv_v16(img, width, height) {\n  var size = width * height;\n  var out = new Uint16Array(size);\n  var r, g, b, max;\n\n  for (var i = 0; i < size; i++) {\n    r = img[4 * i];\n    g = img[4 * i + 1];\n    b = img[4 * i + 2];\n    max = r >= g && r >= b ? r : g >= b && g >= r ? g : b;\n    out[i] = max << 8;\n  }\n\n  return out;\n}\n\nmodule.exports = function unsharp(img, width, height, amount, radius, threshold) {\n  var v1, v2, vmul;\n  var diff, iTimes4;\n\n  if (amount === 0 || radius < 0.5) {\n    return;\n  }\n\n  if (radius > 2.0) {\n    radius = 2.0;\n  }\n\n  var brightness = hsv_v16(img, width, height);\n  var blured = new Uint16Array(brightness); // copy, because blur modify src\n\n  glur_mono16(blured, width, height, radius);\n  var amountFp = amount / 100 * 0x1000 + 0.5 | 0;\n  var thresholdFp = threshold << 8;\n  var size = width * height;\n  /* eslint-disable indent */\n\n  for (var i = 0; i < size; i++) {\n    v1 = brightness[i];\n    diff = v1 - blured[i];\n\n    if (Math.abs(diff) >= thresholdFp) {\n      // add unsharp mask to the brightness channel\n      v2 = v1 + (amountFp * diff + 0x800 >> 12); // Both v1 and v2 are within [0.0 .. 255.0] (0000-FF00) range, never going into\n      // [255.003 .. 255.996] (FF01-FFFF). This allows to round this value as (x+.5)|0\n      // later without overflowing.\n\n      v2 = v2 > 0xff00 ? 0xff00 : v2;\n      v2 = v2 < 0x0000 ? 0x0000 : v2; // Avoid division by 0. V=0 means rgb(0,0,0), unsharp with unsharpAmount>0 cannot\n      // change this value (because diff between colors gets inflated), so no need to verify correctness.\n\n      v1 = v1 !== 0 ? v1 : 1; // Multiplying V in HSV model by a constant is equivalent to multiplying each component\n      // in RGB by the same constant (same for HSL), see also:\n      // https://beesbuzz.biz/code/16-hsv-color-transforms\n\n      vmul = (v2 << 12) / v1 | 0; // Result will be in [0..255] range because:\n      //  - all numbers are positive\n      //  - r,g,b <= (v1/256)\n      //  - r,g,b,(v1/256),(v2/256) <= 255\n      // So highest this number can get is X*255/X+0.5=255.5 which is < 256 and rounds down.\n\n      iTimes4 = i * 4;\n      img[iTimes4] = img[iTimes4] * vmul + 0x800 >> 12; // R\n\n      img[iTimes4 + 1] = img[iTimes4 + 1] * vmul + 0x800 >> 12; // G\n\n      img[iTimes4 + 2] = img[iTimes4 + 2] * vmul + 0x800 >> 12; // B\n    }\n  }\n};\n\n},{\"glur/mono16\":18}],11:[function(_dereq_,module,exports){\n'use strict';\n\nmodule.exports = function unsharp(img, width, height, amount, radius, threshold) {\n  if (amount === 0 || radius < 0.5) {\n    return;\n  }\n\n  if (radius > 2.0) {\n    radius = 2.0;\n  }\n\n  var pixels = width * height;\n  var img_bytes_cnt = pixels * 4;\n  var hsv_bytes_cnt = pixels * 2;\n  var blur_bytes_cnt = pixels * 2;\n  var blur_line_byte_cnt = Math.max(width, height) * 4; // float32 array\n\n  var blur_coeffs_byte_cnt = 8 * 4; // float32 array\n\n  var img_offset = 0;\n  var hsv_offset = img_bytes_cnt;\n  var blur_offset = hsv_offset + hsv_bytes_cnt;\n  var blur_tmp_offset = blur_offset + blur_bytes_cnt;\n  var blur_line_offset = blur_tmp_offset + blur_bytes_cnt;\n  var blur_coeffs_offset = blur_line_offset + blur_line_byte_cnt;\n\n  var instance = this.__instance('unsharp_mask', img_bytes_cnt + hsv_bytes_cnt + blur_bytes_cnt * 2 + blur_line_byte_cnt + blur_coeffs_byte_cnt, {\n    exp: Math.exp\n  }); // 32-bit copy is much faster in chrome\n\n\n  var img32 = new Uint32Array(img.buffer);\n  var mem32 = new Uint32Array(this.__memory.buffer);\n  mem32.set(img32); // HSL\n\n  var fn = instance.exports.hsv_v16 || instance.exports._hsv_v16;\n  fn(img_offset, hsv_offset, width, height); // BLUR\n\n  fn = instance.exports.blurMono16 || instance.exports._blurMono16;\n  fn(hsv_offset, blur_offset, blur_tmp_offset, blur_line_offset, blur_coeffs_offset, width, height, radius); // UNSHARP\n\n  fn = instance.exports.unsharp || instance.exports._unsharp;\n  fn(img_offset, img_offset, hsv_offset, blur_offset, width, height, amount, threshold); // 32-bit copy is much faster in chrome\n\n  img32.set(new Uint32Array(this.__memory.buffer, 0, pixels));\n};\n\n},{}],12:[function(_dereq_,module,exports){\n// This is autogenerated file from math.wasm, don't edit.\n//\n'use strict';\n/* eslint-disable max-len */\n\nmodule.exports = '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';\n\n},{}],13:[function(_dereq_,module,exports){\n'use strict';\n\nvar GC_INTERVAL = 100;\n\nfunction Pool(create, idle) {\n  this.create = create;\n  this.available = [];\n  this.acquired = {};\n  this.lastId = 1;\n  this.timeoutId = 0;\n  this.idle = idle || 2000;\n}\n\nPool.prototype.acquire = function () {\n  var _this = this;\n\n  var resource;\n\n  if (this.available.length !== 0) {\n    resource = this.available.pop();\n  } else {\n    resource = this.create();\n    resource.id = this.lastId++;\n\n    resource.release = function () {\n      return _this.release(resource);\n    };\n  }\n\n  this.acquired[resource.id] = resource;\n  return resource;\n};\n\nPool.prototype.release = function (resource) {\n  var _this2 = this;\n\n  delete this.acquired[resource.id];\n  resource.lastUsed = Date.now();\n  this.available.push(resource);\n\n  if (this.timeoutId === 0) {\n    this.timeoutId = setTimeout(function () {\n      return _this2.gc();\n    }, GC_INTERVAL);\n  }\n};\n\nPool.prototype.gc = function () {\n  var _this3 = this;\n\n  var now = Date.now();\n  this.available = this.available.filter(function (resource) {\n    if (now - resource.lastUsed > _this3.idle) {\n      resource.destroy();\n      return false;\n    }\n\n    return true;\n  });\n\n  if (this.available.length !== 0) {\n    this.timeoutId = setTimeout(function () {\n      return _this3.gc();\n    }, GC_INTERVAL);\n  } else {\n    this.timeoutId = 0;\n  }\n};\n\nmodule.exports = Pool;\n\n},{}],14:[function(_dereq_,module,exports){\n// Add intermediate resizing steps when scaling down by a very large factor.\n//\n// For example, when resizing 10000x10000 down to 10x10, it'll resize it to\n// 300x300 first.\n//\n// It's needed because tiler has issues when the entire tile is scaled down\n// to a few pixels (1024px source tile with border size 3 should result in\n// at least 3+3+2 = 8px target tile, so max scale factor is 128 here).\n//\n// Also, adding intermediate steps can speed up processing if we use lower\n// quality algorithms for first stages.\n//\n'use strict'; // min size = 0 results in infinite loop,\n// min size = 1 can consume large amount of memory\n\nvar MIN_INNER_TILE_SIZE = 2;\n\nmodule.exports = function createStages(fromWidth, fromHeight, toWidth, toHeight, srcTileSize, destTileBorder) {\n  var scaleX = toWidth / fromWidth;\n  var scaleY = toHeight / fromHeight; // derived from createRegions equation:\n  // innerTileWidth = pixelFloor(srcTileSize * scaleX) - 2 * destTileBorder;\n\n  var minScale = (2 * destTileBorder + MIN_INNER_TILE_SIZE + 1) / srcTileSize; // refuse to scale image multiple times by less than twice each time,\n  // it could only happen because of invalid options\n\n  if (minScale > 0.5) return [[toWidth, toHeight]];\n  var stageCount = Math.ceil(Math.log(Math.min(scaleX, scaleY)) / Math.log(minScale)); // no additional resizes are necessary,\n  // stageCount can be zero or be negative when enlarging the image\n\n  if (stageCount <= 1) return [[toWidth, toHeight]];\n  var result = [];\n\n  for (var i = 0; i < stageCount; i++) {\n    var width = Math.round(Math.pow(Math.pow(fromWidth, stageCount - i - 1) * Math.pow(toWidth, i + 1), 1 / stageCount));\n    var height = Math.round(Math.pow(Math.pow(fromHeight, stageCount - i - 1) * Math.pow(toHeight, i + 1), 1 / stageCount));\n    result.push([width, height]);\n  }\n\n  return result;\n};\n\n},{}],15:[function(_dereq_,module,exports){\n// Split original image into multiple 1024x1024 chunks to reduce memory usage\n// (images have to be unpacked into typed arrays for resizing) and allow\n// parallel processing of multiple tiles at a time.\n//\n'use strict';\n/*\n * pixelFloor and pixelCeil are modified versions of Math.floor and Math.ceil\n * functions which take into account floating point arithmetic errors.\n * Those errors can cause undesired increments/decrements of sizes and offsets:\n * Math.ceil(36 / (36 / 500)) = 501\n * pixelCeil(36 / (36 / 500)) = 500\n */\n\nvar PIXEL_EPSILON = 1e-5;\n\nfunction pixelFloor(x) {\n  var nearest = Math.round(x);\n\n  if (Math.abs(x - nearest) < PIXEL_EPSILON) {\n    return nearest;\n  }\n\n  return Math.floor(x);\n}\n\nfunction pixelCeil(x) {\n  var nearest = Math.round(x);\n\n  if (Math.abs(x - nearest) < PIXEL_EPSILON) {\n    return nearest;\n  }\n\n  return Math.ceil(x);\n}\n\nmodule.exports = function createRegions(options) {\n  var scaleX = options.toWidth / options.width;\n  var scaleY = options.toHeight / options.height;\n  var innerTileWidth = pixelFloor(options.srcTileSize * scaleX) - 2 * options.destTileBorder;\n  var innerTileHeight = pixelFloor(options.srcTileSize * scaleY) - 2 * options.destTileBorder; // prevent infinite loop, this should never happen\n\n  if (innerTileWidth < 1 || innerTileHeight < 1) {\n    throw new Error('Internal error in pica: target tile width/height is too small.');\n  }\n\n  var x, y;\n  var innerX, innerY, toTileWidth, toTileHeight;\n  var tiles = [];\n  var tile; // we go top-to-down instead of left-to-right to make image displayed from top to\n  // doesn in the browser\n\n  for (innerY = 0; innerY < options.toHeight; innerY += innerTileHeight) {\n    for (innerX = 0; innerX < options.toWidth; innerX += innerTileWidth) {\n      x = innerX - options.destTileBorder;\n\n      if (x < 0) {\n        x = 0;\n      }\n\n      toTileWidth = innerX + innerTileWidth + options.destTileBorder - x;\n\n      if (x + toTileWidth >= options.toWidth) {\n        toTileWidth = options.toWidth - x;\n      }\n\n      y = innerY - options.destTileBorder;\n\n      if (y < 0) {\n        y = 0;\n      }\n\n      toTileHeight = innerY + innerTileHeight + options.destTileBorder - y;\n\n      if (y + toTileHeight >= options.toHeight) {\n        toTileHeight = options.toHeight - y;\n      }\n\n      tile = {\n        toX: x,\n        toY: y,\n        toWidth: toTileWidth,\n        toHeight: toTileHeight,\n        toInnerX: innerX,\n        toInnerY: innerY,\n        toInnerWidth: innerTileWidth,\n        toInnerHeight: innerTileHeight,\n        offsetX: x / scaleX - pixelFloor(x / scaleX),\n        offsetY: y / scaleY - pixelFloor(y / scaleY),\n        scaleX: scaleX,\n        scaleY: scaleY,\n        x: pixelFloor(x / scaleX),\n        y: pixelFloor(y / scaleY),\n        width: pixelCeil(toTileWidth / scaleX),\n        height: pixelCeil(toTileHeight / scaleY)\n      };\n      tiles.push(tile);\n    }\n  }\n\n  return tiles;\n};\n\n},{}],16:[function(_dereq_,module,exports){\n'use strict';\n\nfunction objClass(obj) {\n  return Object.prototype.toString.call(obj);\n}\n\nmodule.exports.isCanvas = function isCanvas(element) {\n  var cname = objClass(element);\n  return cname === '[object HTMLCanvasElement]'\n  /* browser */\n  || cname === '[object OffscreenCanvas]' || cname === '[object Canvas]'\n  /* node-canvas */\n  ;\n};\n\nmodule.exports.isImage = function isImage(element) {\n  return objClass(element) === '[object HTMLImageElement]';\n};\n\nmodule.exports.isImageBitmap = function isImageBitmap(element) {\n  return objClass(element) === '[object ImageBitmap]';\n};\n\nmodule.exports.limiter = function limiter(concurrency) {\n  var active = 0,\n      queue = [];\n\n  function roll() {\n    if (active < concurrency && queue.length) {\n      active++;\n      queue.shift()();\n    }\n  }\n\n  return function limit(fn) {\n    return new Promise(function (resolve, reject) {\n      queue.push(function () {\n        fn().then(function (result) {\n          resolve(result);\n          active--;\n          roll();\n        }, function (err) {\n          reject(err);\n          active--;\n          roll();\n        });\n      });\n      roll();\n    });\n  };\n};\n\nmodule.exports.cib_quality_name = function cib_quality_name(num) {\n  switch (num) {\n    case 0:\n      return 'pixelated';\n\n    case 1:\n      return 'low';\n\n    case 2:\n      return 'medium';\n  }\n\n  return 'high';\n};\n\nmodule.exports.cib_support = function cib_support(createCanvas) {\n  return Promise.resolve().then(function () {\n    if (typeof createImageBitmap === 'undefined') {\n      return false;\n    }\n\n    var c = createCanvas(100, 100);\n    return createImageBitmap(c, 0, 0, 100, 100, {\n      resizeWidth: 10,\n      resizeHeight: 10,\n      resizeQuality: 'high'\n    }).then(function (bitmap) {\n      var status = bitmap.width === 10; // Branch below is filtered on upper level. We do not call resize\n      // detection for basic ImageBitmap.\n      //\n      // https://developer.mozilla.org/en-US/docs/Web/API/ImageBitmap\n      // old Crome 51 has ImageBitmap without .close(). Then this code\n      // will throw and return 'false' as expected.\n      //\n\n      bitmap.close();\n      c = null;\n      return status;\n    });\n  })[\"catch\"](function () {\n    return false;\n  });\n};\n\nmodule.exports.worker_offscreen_canvas_support = function worker_offscreen_canvas_support() {\n  return new Promise(function (resolve, reject) {\n    if (typeof OffscreenCanvas === 'undefined') {\n      // if OffscreenCanvas is present, we assume browser supports Worker and built-in Promise as well\n      resolve(false);\n      return;\n    }\n\n    function workerPayload(self) {\n      if (typeof createImageBitmap === 'undefined') {\n        self.postMessage(false);\n        return;\n      }\n\n      Promise.resolve().then(function () {\n        var canvas = new OffscreenCanvas(10, 10); // test that 2d context can be used in worker\n\n        var ctx = canvas.getContext('2d');\n        ctx.rect(0, 0, 1, 1); // test that cib can be used to return image bitmap from worker\n\n        return createImageBitmap(canvas, 0, 0, 1, 1);\n      }).then(function () {\n        return self.postMessage(true);\n      }, function () {\n        return self.postMessage(false);\n      });\n    }\n\n    var code = btoa(\"(\".concat(workerPayload.toString(), \")(self);\"));\n    var w = new Worker(\"data:text/javascript;base64,\".concat(code));\n\n    w.onmessage = function (ev) {\n      return resolve(ev.data);\n    };\n\n    w.onerror = reject;\n  }).then(function (result) {\n    return result;\n  }, function () {\n    return false;\n  });\n}; // Check if canvas.getContext('2d').getImageData can be used,\n// FireFox randomizes the output of that function in `privacy.resistFingerprinting` mode\n\n\nmodule.exports.can_use_canvas = function can_use_canvas(createCanvas) {\n  var usable = false;\n\n  try {\n    var canvas = createCanvas(2, 1);\n    var ctx = canvas.getContext('2d');\n    var d = ctx.createImageData(2, 1);\n    d.data[0] = 12;\n    d.data[1] = 23;\n    d.data[2] = 34;\n    d.data[3] = 255;\n    d.data[4] = 45;\n    d.data[5] = 56;\n    d.data[6] = 67;\n    d.data[7] = 255;\n    ctx.putImageData(d, 0, 0);\n    d = null;\n    d = ctx.getImageData(0, 0, 2, 1);\n\n    if (d.data[0] === 12 && d.data[1] === 23 && d.data[2] === 34 && d.data[3] === 255 && d.data[4] === 45 && d.data[5] === 56 && d.data[6] === 67 && d.data[7] === 255) {\n      usable = true;\n    }\n  } catch (err) {}\n\n  return usable;\n}; // Check if createImageBitmap(img, sx, sy, sw, sh) signature works correctly\n// with JPEG images oriented with Exif;\n// https://bugs.chromium.org/p/chromium/issues/detail?id=1220671\n// TODO: remove after it's fixed in chrome for at least 2 releases\n\n\nmodule.exports.cib_can_use_region = function cib_can_use_region() {\n  return new Promise(function (resolve) {\n    // `Image` check required for use in `ServiceWorker`\n    if (typeof Image === 'undefined' || typeof createImageBitmap === 'undefined') {\n      resolve(false);\n      return;\n    }\n\n    var image = new Image();\n    image.src = 'data:image/jpeg;base64,' + '/9j/4QBiRXhpZgAATU0AKgAAAAgABQESAAMAAAABAAYAAAEaAAUAAAABAAAASgEbAAUAA' + 'AABAAAAUgEoAAMAAAABAAIAAAITAAMAAAABAAEAAAAAAAAAAABIAAAAAQAAAEgAAAAB/9' + 'sAQwAEAwMEAwMEBAMEBQQEBQYKBwYGBgYNCQoICg8NEBAPDQ8OERMYFBESFxIODxUcFRc' + 'ZGRsbGxAUHR8dGh8YGhsa/9sAQwEEBQUGBQYMBwcMGhEPERoaGhoaGhoaGhoaGhoaGhoa' + 'GhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoa/8IAEQgAAQACAwERAAIRAQMRA' + 'f/EABQAAQAAAAAAAAAAAAAAAAAAAAf/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAA' + 'IQAxAAAAF/P//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAQUCf//EABQRAQAAAAA' + 'AAAAAAAAAAAAAAAD/2gAIAQMBAT8Bf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQIB' + 'AT8Bf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEABj8Cf//EABQQAQAAAAAAAAAAA' + 'AAAAAAAAAD/2gAIAQEAAT8hf//aAAwDAQACAAMAAAAQH//EABQRAQAAAAAAAAAAAAAAAA' + 'AAAAD/2gAIAQMBAT8Qf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQIBAT8Qf//EABQ' + 'QAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAT8Qf//Z';\n\n    image.onload = function () {\n      createImageBitmap(image, 0, 0, image.width, image.height).then(function (bitmap) {\n        if (bitmap.width === image.width && bitmap.height === image.height) {\n          resolve(true);\n        } else {\n          resolve(false);\n        }\n      }, function () {\n        return resolve(false);\n      });\n    };\n\n    image.onerror = function () {\n      return resolve(false);\n    };\n  });\n};\n\n},{}],17:[function(_dereq_,module,exports){\n// Web Worker wrapper for image resize function\n'use strict';\n\nmodule.exports = function () {\n  var MathLib = _dereq_('./mathlib');\n\n  var mathLib;\n  /* eslint-disable no-undef */\n\n  onmessage = function onmessage(ev) {\n    var tileOpts = ev.data.opts;\n    var returnBitmap = false;\n\n    if (!tileOpts.src && tileOpts.srcBitmap) {\n      var canvas = new OffscreenCanvas(tileOpts.width, tileOpts.height);\n      var ctx = canvas.getContext('2d');\n      ctx.drawImage(tileOpts.srcBitmap, 0, 0);\n      tileOpts.src = ctx.getImageData(0, 0, tileOpts.width, tileOpts.height).data;\n      canvas.width = canvas.height = 0;\n      canvas = null;\n      tileOpts.srcBitmap.close();\n      tileOpts.srcBitmap = null; // Temporary force out data to typed array, because Chrome have artefacts\n      // https://github.com/nodeca/pica/issues/223\n      // returnBitmap = true;\n    }\n\n    if (!mathLib) mathLib = new MathLib(ev.data.features); // Use multimath's sync auto-init. Avoid Promise use in old browsers,\n    // because polyfills are not propagated to webworker.\n\n    var data = mathLib.resizeAndUnsharp(tileOpts);\n\n    if (returnBitmap) {\n      var toImageData = new ImageData(new Uint8ClampedArray(data), tileOpts.toWidth, tileOpts.toHeight);\n\n      var _canvas = new OffscreenCanvas(tileOpts.toWidth, tileOpts.toHeight);\n\n      var _ctx = _canvas.getContext('2d');\n\n      _ctx.putImageData(toImageData, 0, 0);\n\n      createImageBitmap(_canvas).then(function (bitmap) {\n        postMessage({\n          bitmap: bitmap\n        }, [bitmap]);\n      });\n    } else {\n      postMessage({\n        data: data\n      }, [data.buffer]);\n    }\n  };\n};\n\n},{\"./mathlib\":1}],18:[function(_dereq_,module,exports){\n// Calculate Gaussian blur of an image using IIR filter\n// The method is taken from Intel's white paper and code example attached to it:\n// https://software.intel.com/en-us/articles/iir-gaussian-blur-filter\n// -implementation-using-intel-advanced-vector-extensions\n\nvar a0, a1, a2, a3, b1, b2, left_corner, right_corner;\n\nfunction gaussCoef(sigma) {\n  if (sigma < 0.5) {\n    sigma = 0.5;\n  }\n\n  var a = Math.exp(0.726 * 0.726) / sigma,\n      g1 = Math.exp(-a),\n      g2 = Math.exp(-2 * a),\n      k = (1 - g1) * (1 - g1) / (1 + 2 * a * g1 - g2);\n\n  a0 = k;\n  a1 = k * (a - 1) * g1;\n  a2 = k * (a + 1) * g1;\n  a3 = -k * g2;\n  b1 = 2 * g1;\n  b2 = -g2;\n  left_corner = (a0 + a1) / (1 - b1 - b2);\n  right_corner = (a2 + a3) / (1 - b1 - b2);\n\n  // Attempt to force type to FP32.\n  return new Float32Array([ a0, a1, a2, a3, b1, b2, left_corner, right_corner ]);\n}\n\nfunction convolveMono16(src, out, line, coeff, width, height) {\n  // takes src image and writes the blurred and transposed result into out\n\n  var prev_src, curr_src, curr_out, prev_out, prev_prev_out;\n  var src_index, out_index, line_index;\n  var i, j;\n  var coeff_a0, coeff_a1, coeff_b1, coeff_b2;\n\n  for (i = 0; i < height; i++) {\n    src_index = i * width;\n    out_index = i;\n    line_index = 0;\n\n    // left to right\n    prev_src = src[src_index];\n    prev_prev_out = prev_src * coeff[6];\n    prev_out = prev_prev_out;\n\n    coeff_a0 = coeff[0];\n    coeff_a1 = coeff[1];\n    coeff_b1 = coeff[4];\n    coeff_b2 = coeff[5];\n\n    for (j = 0; j < width; j++) {\n      curr_src = src[src_index];\n\n      curr_out = curr_src * coeff_a0 +\n                 prev_src * coeff_a1 +\n                 prev_out * coeff_b1 +\n                 prev_prev_out * coeff_b2;\n\n      prev_prev_out = prev_out;\n      prev_out = curr_out;\n      prev_src = curr_src;\n\n      line[line_index] = prev_out;\n      line_index++;\n      src_index++;\n    }\n\n    src_index--;\n    line_index--;\n    out_index += height * (width - 1);\n\n    // right to left\n    prev_src = src[src_index];\n    prev_prev_out = prev_src * coeff[7];\n    prev_out = prev_prev_out;\n    curr_src = prev_src;\n\n    coeff_a0 = coeff[2];\n    coeff_a1 = coeff[3];\n\n    for (j = width - 1; j >= 0; j--) {\n      curr_out = curr_src * coeff_a0 +\n                 prev_src * coeff_a1 +\n                 prev_out * coeff_b1 +\n                 prev_prev_out * coeff_b2;\n\n      prev_prev_out = prev_out;\n      prev_out = curr_out;\n\n      prev_src = curr_src;\n      curr_src = src[src_index];\n\n      out[out_index] = line[line_index] + prev_out;\n\n      src_index--;\n      line_index--;\n      out_index -= height;\n    }\n  }\n}\n\n\nfunction blurMono16(src, width, height, radius) {\n  // Quick exit on zero radius\n  if (!radius) { return; }\n\n  var out      = new Uint16Array(src.length),\n      tmp_line = new Float32Array(Math.max(width, height));\n\n  var coeff = gaussCoef(radius);\n\n  convolveMono16(src, out, tmp_line, coeff, width, height, radius);\n  convolveMono16(out, src, tmp_line, coeff, height, width, radius);\n}\n\nmodule.exports = blurMono16;\n\n},{}],19:[function(_dereq_,module,exports){\n'use strict';\n\n\nvar assign         = _dereq_('object-assign');\nvar base64decode   = _dereq_('./lib/base64decode');\nvar hasWebAssembly = _dereq_('./lib/wa_detect');\n\n\nvar DEFAULT_OPTIONS = {\n  js: true,\n  wasm: true\n};\n\n\nfunction MultiMath(options) {\n  if (!(this instanceof MultiMath)) return new MultiMath(options);\n\n  var opts = assign({}, DEFAULT_OPTIONS, options || {});\n\n  this.options         = opts;\n\n  this.__cache         = {};\n\n  this.__init_promise  = null;\n  this.__modules       = opts.modules || {};\n  this.__memory        = null;\n  this.__wasm          = {};\n\n  this.__isLE = ((new Uint32Array((new Uint8Array([ 1, 0, 0, 0 ])).buffer))[0] === 1);\n\n  if (!this.options.js && !this.options.wasm) {\n    throw new Error('mathlib: at least \"js\" or \"wasm\" should be enabled');\n  }\n}\n\n\nMultiMath.prototype.has_wasm = hasWebAssembly;\n\n\nMultiMath.prototype.use = function (module) {\n  this.__modules[module.name] = module;\n\n  // Pin the best possible implementation\n  if (this.options.wasm && this.has_wasm() && module.wasm_fn) {\n    this[module.name] = module.wasm_fn;\n  } else {\n    this[module.name] = module.fn;\n  }\n\n  return this;\n};\n\n\nMultiMath.prototype.init = function () {\n  if (this.__init_promise) return this.__init_promise;\n\n  if (!this.options.js && this.options.wasm && !this.has_wasm()) {\n    return Promise.reject(new Error('mathlib: only \"wasm\" was enabled, but it\\'s not supported'));\n  }\n\n  var self = this;\n\n  this.__init_promise = Promise.all(Object.keys(self.__modules).map(function (name) {\n    var module = self.__modules[name];\n\n    if (!self.options.wasm || !self.has_wasm() || !module.wasm_fn) return null;\n\n    // If already compiled - exit\n    if (self.__wasm[name]) return null;\n\n    // Compile wasm source\n    return WebAssembly.compile(self.__base64decode(module.wasm_src))\n      .then(function (m) { self.__wasm[name] = m; });\n  }))\n    .then(function () { return self; });\n\n  return this.__init_promise;\n};\n\n\n////////////////////////////////////////////////////////////////////////////////\n// Methods below are for internal use from plugins\n\n\n// Simple decode base64 to typed array. Useful to load embedded webassembly\n// code. You probably don't need to call this method directly.\n//\nMultiMath.prototype.__base64decode = base64decode;\n\n\n// Increase current memory to include specified number of bytes. Do nothing if\n// size is already ok. You probably don't need to call this method directly,\n// because it will be invoked from `.__instance()`.\n//\nMultiMath.prototype.__reallocate = function mem_grow_to(bytes) {\n  if (!this.__memory) {\n    this.__memory = new WebAssembly.Memory({\n      initial: Math.ceil(bytes / (64 * 1024))\n    });\n    return this.__memory;\n  }\n\n  var mem_size = this.__memory.buffer.byteLength;\n\n  if (mem_size < bytes) {\n    this.__memory.grow(Math.ceil((bytes - mem_size) / (64 * 1024)));\n  }\n\n  return this.__memory;\n};\n\n\n// Returns instantinated webassembly item by name, with specified memory size\n// and environment.\n// - use cache if available\n// - do sync module init, if async init was not called earlier\n// - allocate memory if not enougth\n// - can export functions to webassembly via \"env_extra\",\n//   for example, { exp: Math.exp }\n//\nMultiMath.prototype.__instance = function instance(name, memsize, env_extra) {\n  if (memsize) this.__reallocate(memsize);\n\n  // If .init() was not called, do sync compile\n  if (!this.__wasm[name]) {\n    var module = this.__modules[name];\n    this.__wasm[name] = new WebAssembly.Module(this.__base64decode(module.wasm_src));\n  }\n\n  if (!this.__cache[name]) {\n    var env_base = {\n      memoryBase: 0,\n      memory: this.__memory,\n      tableBase: 0,\n      table: new WebAssembly.Table({ initial: 0, element: 'anyfunc' })\n    };\n\n    this.__cache[name] = new WebAssembly.Instance(this.__wasm[name], {\n      env: assign(env_base, env_extra || {})\n    });\n  }\n\n  return this.__cache[name];\n};\n\n\n// Helper to calculate memory aligh for pointers. Webassembly does not require\n// this, but you may wish to experiment. Default base = 8;\n//\nMultiMath.prototype.__align = function align(number, base) {\n  base = base || 8;\n  var reminder = number % base;\n  return number + (reminder ? base - reminder : 0);\n};\n\n\nmodule.exports = MultiMath;\n\n},{\"./lib/base64decode\":20,\"./lib/wa_detect\":21,\"object-assign\":22}],20:[function(_dereq_,module,exports){\n// base64 decode str -> Uint8Array, to load WA modules\n//\n'use strict';\n\n\nvar BASE64_MAP = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n\n\nmodule.exports = function base64decode(str) {\n  var input = str.replace(/[\\r\\n=]/g, ''), // remove CR/LF & padding to simplify scan\n      max   = input.length;\n\n  var out = new Uint8Array((max * 3) >> 2);\n\n  // Collect by 6*4 bits (3 bytes)\n\n  var bits = 0;\n  var ptr  = 0;\n\n  for (var idx = 0; idx < max; idx++) {\n    if ((idx % 4 === 0) && idx) {\n      out[ptr++] = (bits >> 16) & 0xFF;\n      out[ptr++] = (bits >> 8) & 0xFF;\n      out[ptr++] = bits & 0xFF;\n    }\n\n    bits = (bits << 6) | BASE64_MAP.indexOf(input.charAt(idx));\n  }\n\n  // Dump tail\n\n  var tailbits = (max % 4) * 6;\n\n  if (tailbits === 0) {\n    out[ptr++] = (bits >> 16) & 0xFF;\n    out[ptr++] = (bits >> 8) & 0xFF;\n    out[ptr++] = bits & 0xFF;\n  } else if (tailbits === 18) {\n    out[ptr++] = (bits >> 10) & 0xFF;\n    out[ptr++] = (bits >> 2) & 0xFF;\n  } else if (tailbits === 12) {\n    out[ptr++] = (bits >> 4) & 0xFF;\n  }\n\n  return out;\n};\n\n},{}],21:[function(_dereq_,module,exports){\n// Detect WebAssembly support.\n// - Check global WebAssembly object\n// - Try to load simple module (can be disabled via CSP)\n//\n'use strict';\n\n\nvar wa;\n\n\nmodule.exports = function hasWebAssembly() {\n  // use cache if called before;\n  if (typeof wa !== 'undefined') return wa;\n\n  wa = false;\n\n  if (typeof WebAssembly === 'undefined') return wa;\n\n  // If WebAssenbly is disabled, code can throw on compile\n  try {\n    // https://github.com/brion/min-wasm-fail/blob/master/min-wasm-fail.in.js\n    // Additional check that WA internals are correct\n\n    /* eslint-disable comma-spacing, max-len */\n    var bin      = new Uint8Array([ 0,97,115,109,1,0,0,0,1,6,1,96,1,127,1,127,3,2,1,0,5,3,1,0,1,7,8,1,4,116,101,115,116,0,0,10,16,1,14,0,32,0,65,1,54,2,0,32,0,40,2,0,11 ]);\n    var module   = new WebAssembly.Module(bin);\n    var instance = new WebAssembly.Instance(module, {});\n\n    // test storing to and loading from a non-zero location via a parameter.\n    // Safari on iOS 11.2.5 returns 0 unexpectedly at non-zero locations\n    if (instance.exports.test(4) !== 0) wa = true;\n\n    return wa;\n  } catch (__) {}\n\n  return wa;\n};\n\n},{}],22:[function(_dereq_,module,exports){\n/*\nobject-assign\n(c) Sindre Sorhus\n@license MIT\n*/\n\n'use strict';\n/* eslint-disable no-unused-vars */\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n\tif (val === null || val === undefined) {\n\t\tthrow new TypeError('Object.assign cannot be called with null or undefined');\n\t}\n\n\treturn Object(val);\n}\n\nfunction shouldUseNative() {\n\ttry {\n\t\tif (!Object.assign) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Detect buggy property enumeration order in older V8 versions.\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\t\tvar test1 = new String('abc');  // eslint-disable-line no-new-wrappers\n\t\ttest1[5] = 'de';\n\t\tif (Object.getOwnPropertyNames(test1)[0] === '5') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test2 = {};\n\t\tfor (var i = 0; i < 10; i++) {\n\t\t\ttest2['_' + String.fromCharCode(i)] = i;\n\t\t}\n\t\tvar order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n\t\t\treturn test2[n];\n\t\t});\n\t\tif (order2.join('') !== '0123456789') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test3 = {};\n\t\t'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n\t\t\ttest3[letter] = letter;\n\t\t});\n\t\tif (Object.keys(Object.assign({}, test3)).join('') !==\n\t\t\t\t'abcdefghijklmnopqrst') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} catch (err) {\n\t\t// We don't expect any of the above to throw, but better to be safe.\n\t\treturn false;\n\t}\n}\n\nmodule.exports = shouldUseNative() ? Object.assign : function (target, source) {\n\tvar from;\n\tvar to = toObject(target);\n\tvar symbols;\n\n\tfor (var s = 1; s < arguments.length; s++) {\n\t\tfrom = Object(arguments[s]);\n\n\t\tfor (var key in from) {\n\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\tto[key] = from[key];\n\t\t\t}\n\t\t}\n\n\t\tif (getOwnPropertySymbols) {\n\t\t\tsymbols = getOwnPropertySymbols(from);\n\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn to;\n};\n\n},{}],23:[function(_dereq_,module,exports){\nvar bundleFn = arguments[3];\nvar sources = arguments[4];\nvar cache = arguments[5];\n\nvar stringify = JSON.stringify;\n\nmodule.exports = function (fn, options) {\n    var wkey;\n    var cacheKeys = Object.keys(cache);\n\n    for (var i = 0, l = cacheKeys.length; i < l; i++) {\n        var key = cacheKeys[i];\n        var exp = cache[key].exports;\n        // Using babel as a transpiler to use esmodule, the export will always\n        // be an object with the default export as a property of it. To ensure\n        // the existing api and babel esmodule exports are both supported we\n        // check for both\n        if (exp === fn || exp && exp.default === fn) {\n            wkey = key;\n            break;\n        }\n    }\n\n    if (!wkey) {\n        wkey = Math.floor(Math.pow(16, 8) * Math.random()).toString(16);\n        var wcache = {};\n        for (var i = 0, l = cacheKeys.length; i < l; i++) {\n            var key = cacheKeys[i];\n            wcache[key] = key;\n        }\n        sources[wkey] = [\n            'function(require,module,exports){' + fn + '(self); }',\n            wcache\n        ];\n    }\n    var skey = Math.floor(Math.pow(16, 8) * Math.random()).toString(16);\n\n    var scache = {}; scache[wkey] = wkey;\n    sources[skey] = [\n        'function(require,module,exports){' +\n            // try to call default if defined to also support babel esmodule exports\n            'var f = require(' + stringify(wkey) + ');' +\n            '(f.default ? f.default : f)(self);' +\n        '}',\n        scache\n    ];\n\n    var workerSources = {};\n    resolveSources(skey);\n\n    function resolveSources(key) {\n        workerSources[key] = true;\n\n        for (var depPath in sources[key][1]) {\n            var depKey = sources[key][1][depPath];\n            if (!workerSources[depKey]) {\n                resolveSources(depKey);\n            }\n        }\n    }\n\n    var src = '(' + bundleFn + ')({'\n        + Object.keys(workerSources).map(function (key) {\n            return stringify(key) + ':['\n                + sources[key][0]\n                + ',' + stringify(sources[key][1]) + ']'\n            ;\n        }).join(',')\n        + '},{},[' + stringify(skey) + '])'\n    ;\n\n    var URL = window.URL || window.webkitURL || window.mozURL || window.msURL;\n\n    var blob = new Blob([src], { type: 'text/javascript' });\n    if (options && options.bare) { return blob; }\n    var workerUrl = URL.createObjectURL(blob);\n    var worker = new Worker(workerUrl);\n    worker.objectURL = workerUrl;\n    return worker;\n};\n\n},{}],\"/index.js\":[function(_dereq_,module,exports){\n'use strict';\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nvar assign = _dereq_('object-assign');\n\nvar webworkify = _dereq_('webworkify');\n\nvar MathLib = _dereq_('./lib/mathlib');\n\nvar Pool = _dereq_('./lib/pool');\n\nvar utils = _dereq_('./lib/utils');\n\nvar worker = _dereq_('./lib/worker');\n\nvar createStages = _dereq_('./lib/stepper');\n\nvar createRegions = _dereq_('./lib/tiler');\n\nvar filter_info = _dereq_('./lib/mm_resize/resize_filter_info'); // Deduplicate pools & limiters with the same configs\n// when user creates multiple pica instances.\n\n\nvar singletones = {};\nvar NEED_SAFARI_FIX = false;\n\ntry {\n  if (typeof navigator !== 'undefined' && navigator.userAgent) {\n    NEED_SAFARI_FIX = navigator.userAgent.indexOf('Safari') >= 0;\n  }\n} catch (e) {}\n\nvar concurrency = 1;\n\nif (typeof navigator !== 'undefined') {\n  concurrency = Math.min(navigator.hardwareConcurrency || 1, 4);\n}\n\nvar DEFAULT_PICA_OPTS = {\n  tile: 1024,\n  concurrency: concurrency,\n  features: ['js', 'wasm', 'ww'],\n  idle: 2000,\n  createCanvas: function createCanvas(width, height) {\n    var tmpCanvas = document.createElement('canvas');\n    tmpCanvas.width = width;\n    tmpCanvas.height = height;\n    return tmpCanvas;\n  }\n};\nvar DEFAULT_RESIZE_OPTS = {\n  filter: 'mks2013',\n  unsharpAmount: 0,\n  unsharpRadius: 0.0,\n  unsharpThreshold: 0\n};\nvar CAN_NEW_IMAGE_DATA = false;\nvar CAN_CREATE_IMAGE_BITMAP = false;\nvar CAN_USE_CANVAS_GET_IMAGE_DATA = false;\nvar CAN_USE_OFFSCREEN_CANVAS = false;\nvar CAN_USE_CIB_REGION_FOR_IMAGE = false;\n\nfunction workerFabric() {\n  return {\n    value: webworkify(worker),\n    destroy: function destroy() {\n      this.value.terminate();\n\n      if (typeof window !== 'undefined') {\n        var url = window.URL || window.webkitURL || window.mozURL || window.msURL;\n\n        if (url && url.revokeObjectURL && this.value.objectURL) {\n          url.revokeObjectURL(this.value.objectURL);\n        }\n      }\n    }\n  };\n} ////////////////////////////////////////////////////////////////////////////////\n// API methods\n\n\nfunction Pica(options) {\n  if (!(this instanceof Pica)) return new Pica(options);\n  this.options = assign({}, DEFAULT_PICA_OPTS, options || {});\n  var limiter_key = \"lk_\".concat(this.options.concurrency); // Share limiters to avoid multiple parallel workers when user creates\n  // multiple pica instances.\n\n  this.__limit = singletones[limiter_key] || utils.limiter(this.options.concurrency);\n  if (!singletones[limiter_key]) singletones[limiter_key] = this.__limit; // List of supported features, according to options & browser/node.js\n\n  this.features = {\n    js: false,\n    // pure JS implementation, can be disabled for testing\n    wasm: false,\n    // webassembly implementation for heavy functions\n    cib: false,\n    // resize via createImageBitmap (only FF at this moment)\n    ww: false // webworkers\n\n  };\n  this.__workersPool = null; // Store requested features for webworkers\n\n  this.__requested_features = [];\n  this.__mathlib = null;\n}\n\nPica.prototype.init = function () {\n  var _this = this;\n\n  if (this.__initPromise) return this.__initPromise; // Test if we can create ImageData without canvas and memory copy\n\n  if (typeof ImageData !== 'undefined' && typeof Uint8ClampedArray !== 'undefined') {\n    try {\n      /* eslint-disable no-new */\n      new ImageData(new Uint8ClampedArray(400), 10, 10);\n      CAN_NEW_IMAGE_DATA = true;\n    } catch (__) {}\n  } // ImageBitmap can be effective in 2 places:\n  //\n  // 1. Threaded jpeg unpack (basic)\n  // 2. Built-in resize (blocked due problem in chrome, see issue #89)\n  //\n  // For basic use we also need ImageBitmap wo support .close() method,\n  // see https://developer.mozilla.org/ru/docs/Web/API/ImageBitmap\n\n\n  if (typeof ImageBitmap !== 'undefined') {\n    if (ImageBitmap.prototype && ImageBitmap.prototype.close) {\n      CAN_CREATE_IMAGE_BITMAP = true;\n    } else {\n      this.debug('ImageBitmap does not support .close(), disabled');\n    }\n  }\n\n  var features = this.options.features.slice();\n\n  if (features.indexOf('all') >= 0) {\n    features = ['cib', 'wasm', 'js', 'ww'];\n  }\n\n  this.__requested_features = features;\n  this.__mathlib = new MathLib(features); // Check WebWorker support if requested\n\n  if (features.indexOf('ww') >= 0) {\n    if (typeof window !== 'undefined' && 'Worker' in window) {\n      // IE <= 11 don't allow to create webworkers from string. We should check it.\n      // https://connect.microsoft.com/IE/feedback/details/801810/web-workers-from-blob-urls-in-ie-10-and-11\n      try {\n        var wkr = _dereq_('webworkify')(function () {});\n\n        wkr.terminate();\n        this.features.ww = true; // pool uniqueness depends on pool config + webworker config\n\n        var wpool_key = \"wp_\".concat(JSON.stringify(this.options));\n\n        if (singletones[wpool_key]) {\n          this.__workersPool = singletones[wpool_key];\n        } else {\n          this.__workersPool = new Pool(workerFabric, this.options.idle);\n          singletones[wpool_key] = this.__workersPool;\n        }\n      } catch (__) {}\n    }\n  }\n\n  var initMath = this.__mathlib.init().then(function (mathlib) {\n    // Copy detected features\n    assign(_this.features, mathlib.features);\n  });\n\n  var checkCibResize;\n\n  if (!CAN_CREATE_IMAGE_BITMAP) {\n    checkCibResize = Promise.resolve(false);\n  } else {\n    checkCibResize = utils.cib_support(this.options.createCanvas).then(function (status) {\n      if (_this.features.cib && features.indexOf('cib') < 0) {\n        _this.debug('createImageBitmap() resize supported, but disabled by config');\n\n        return;\n      }\n\n      if (features.indexOf('cib') >= 0) _this.features.cib = status;\n    });\n  }\n\n  CAN_USE_CANVAS_GET_IMAGE_DATA = utils.can_use_canvas(this.options.createCanvas);\n  var checkOffscreenCanvas;\n\n  if (CAN_CREATE_IMAGE_BITMAP && CAN_NEW_IMAGE_DATA && features.indexOf('ww') !== -1) {\n    checkOffscreenCanvas = utils.worker_offscreen_canvas_support();\n  } else {\n    checkOffscreenCanvas = Promise.resolve(false);\n  }\n\n  checkOffscreenCanvas = checkOffscreenCanvas.then(function (result) {\n    CAN_USE_OFFSCREEN_CANVAS = result;\n  }); // we use createImageBitmap to crop image data and pass it to workers,\n  // so need to check whether function works correctly;\n  // https://bugs.chromium.org/p/chromium/issues/detail?id=1220671\n\n  var checkCibRegion = utils.cib_can_use_region().then(function (result) {\n    CAN_USE_CIB_REGION_FOR_IMAGE = result;\n  }); // Init math lib. That's async because can load some\n\n  this.__initPromise = Promise.all([initMath, checkCibResize, checkOffscreenCanvas, checkCibRegion]).then(function () {\n    return _this;\n  });\n  return this.__initPromise;\n}; // Call resizer in webworker or locally, depending on config\n\n\nPica.prototype.__invokeResize = function (tileOpts, opts) {\n  var _this2 = this;\n\n  // Share cache between calls:\n  //\n  // - wasm instance\n  // - wasm memory object\n  //\n  opts.__mathCache = opts.__mathCache || {};\n  return Promise.resolve().then(function () {\n    if (!_this2.features.ww) {\n      // not possible to have ImageBitmap here if user disabled WW\n      return {\n        data: _this2.__mathlib.resizeAndUnsharp(tileOpts, opts.__mathCache)\n      };\n    }\n\n    return new Promise(function (resolve, reject) {\n      var w = _this2.__workersPool.acquire();\n\n      if (opts.cancelToken) opts.cancelToken[\"catch\"](function (err) {\n        return reject(err);\n      });\n\n      w.value.onmessage = function (ev) {\n        w.release();\n        if (ev.data.err) reject(ev.data.err);else resolve(ev.data);\n      };\n\n      var transfer = [];\n      if (tileOpts.src) transfer.push(tileOpts.src.buffer);\n      if (tileOpts.srcBitmap) transfer.push(tileOpts.srcBitmap);\n      w.value.postMessage({\n        opts: tileOpts,\n        features: _this2.__requested_features,\n        preload: {\n          wasm_nodule: _this2.__mathlib.__\n        }\n      }, transfer);\n    });\n  });\n}; // this function can return promise if createImageBitmap is used\n\n\nPica.prototype.__extractTileData = function (tile, from, opts, stageEnv, extractTo) {\n  if (this.features.ww && CAN_USE_OFFSCREEN_CANVAS && ( // createImageBitmap doesn't work for images (Image, ImageBitmap) with Exif orientation in Chrome,\n  // can use canvas because canvas doesn't have orientation;\n  // see https://bugs.chromium.org/p/chromium/issues/detail?id=1220671\n  utils.isCanvas(from) || CAN_USE_CIB_REGION_FOR_IMAGE)) {\n    this.debug('Create tile for OffscreenCanvas');\n    return createImageBitmap(stageEnv.srcImageBitmap || from, tile.x, tile.y, tile.width, tile.height).then(function (bitmap) {\n      extractTo.srcBitmap = bitmap;\n      return extractTo;\n    });\n  } // Extract tile RGBA buffer, depending on input type\n\n\n  if (utils.isCanvas(from)) {\n    if (!stageEnv.srcCtx) stageEnv.srcCtx = from.getContext('2d'); // If input is Canvas - extract region data directly\n\n    this.debug('Get tile pixel data');\n    extractTo.src = stageEnv.srcCtx.getImageData(tile.x, tile.y, tile.width, tile.height).data;\n    return extractTo;\n  } // If input is Image or decoded to ImageBitmap,\n  // draw region to temporary canvas and extract data from it\n  //\n  // Note! Attempt to reuse this canvas causes significant slowdown in chrome\n  //\n\n\n  this.debug('Draw tile imageBitmap/image to temporary canvas');\n  var tmpCanvas = this.options.createCanvas(tile.width, tile.height);\n  var tmpCtx = tmpCanvas.getContext('2d');\n  tmpCtx.globalCompositeOperation = 'copy';\n  tmpCtx.drawImage(stageEnv.srcImageBitmap || from, tile.x, tile.y, tile.width, tile.height, 0, 0, tile.width, tile.height);\n  this.debug('Get tile pixel data');\n  extractTo.src = tmpCtx.getImageData(0, 0, tile.width, tile.height).data; // Safari 12 workaround\n  // https://github.com/nodeca/pica/issues/199\n\n  tmpCanvas.width = tmpCanvas.height = 0;\n  return extractTo;\n};\n\nPica.prototype.__landTileData = function (tile, result, stageEnv) {\n  var toImageData;\n  this.debug('Convert raw rgba tile result to ImageData');\n\n  if (result.bitmap) {\n    stageEnv.toCtx.drawImage(result.bitmap, tile.toX, tile.toY);\n    return null;\n  }\n\n  if (CAN_NEW_IMAGE_DATA) {\n    // this branch is for modern browsers\n    // If `new ImageData()` & Uint8ClampedArray suported\n    toImageData = new ImageData(new Uint8ClampedArray(result.data), tile.toWidth, tile.toHeight);\n  } else {\n    // fallback for `node-canvas` and old browsers\n    // (IE11 has ImageData but does not support `new ImageData()`)\n    toImageData = stageEnv.toCtx.createImageData(tile.toWidth, tile.toHeight);\n\n    if (toImageData.data.set) {\n      toImageData.data.set(result.data);\n    } else {\n      // IE9 don't have `.set()`\n      for (var i = toImageData.data.length - 1; i >= 0; i--) {\n        toImageData.data[i] = result.data[i];\n      }\n    }\n  }\n\n  this.debug('Draw tile');\n\n  if (NEED_SAFARI_FIX) {\n    // Safari draws thin white stripes between tiles without this fix\n    stageEnv.toCtx.putImageData(toImageData, tile.toX, tile.toY, tile.toInnerX - tile.toX, tile.toInnerY - tile.toY, tile.toInnerWidth + 1e-5, tile.toInnerHeight + 1e-5);\n  } else {\n    stageEnv.toCtx.putImageData(toImageData, tile.toX, tile.toY, tile.toInnerX - tile.toX, tile.toInnerY - tile.toY, tile.toInnerWidth, tile.toInnerHeight);\n  }\n\n  return null;\n};\n\nPica.prototype.__tileAndResize = function (from, to, opts) {\n  var _this3 = this;\n\n  var stageEnv = {\n    srcCtx: null,\n    srcImageBitmap: null,\n    isImageBitmapReused: false,\n    toCtx: null\n  };\n\n  var processTile = function processTile(tile) {\n    return _this3.__limit(function () {\n      if (opts.canceled) return opts.cancelToken;\n      var tileOpts = {\n        width: tile.width,\n        height: tile.height,\n        toWidth: tile.toWidth,\n        toHeight: tile.toHeight,\n        scaleX: tile.scaleX,\n        scaleY: tile.scaleY,\n        offsetX: tile.offsetX,\n        offsetY: tile.offsetY,\n        filter: opts.filter,\n        unsharpAmount: opts.unsharpAmount,\n        unsharpRadius: opts.unsharpRadius,\n        unsharpThreshold: opts.unsharpThreshold\n      };\n\n      _this3.debug('Invoke resize math');\n\n      return Promise.resolve(tileOpts).then(function (tileOpts) {\n        return _this3.__extractTileData(tile, from, opts, stageEnv, tileOpts);\n      }).then(function (tileOpts) {\n        _this3.debug('Invoke resize math');\n\n        return _this3.__invokeResize(tileOpts, opts);\n      }).then(function (result) {\n        if (opts.canceled) return opts.cancelToken;\n        stageEnv.srcImageData = null;\n        return _this3.__landTileData(tile, result, stageEnv);\n      });\n    });\n  }; // Need to normalize data source first. It can be canvas or image.\n  // If image - try to decode in background if possible\n\n\n  return Promise.resolve().then(function () {\n    stageEnv.toCtx = to.getContext('2d');\n    if (utils.isCanvas(from)) return null;\n\n    if (utils.isImageBitmap(from)) {\n      stageEnv.srcImageBitmap = from;\n      stageEnv.isImageBitmapReused = true;\n      return null;\n    }\n\n    if (utils.isImage(from)) {\n      // try do decode image in background for faster next operations;\n      // if we're using offscreen canvas, cib is called per tile, so not needed here\n      if (!CAN_CREATE_IMAGE_BITMAP) return null;\n\n      _this3.debug('Decode image via createImageBitmap');\n\n      return createImageBitmap(from).then(function (imageBitmap) {\n        stageEnv.srcImageBitmap = imageBitmap;\n      }) // Suppress error to use fallback, if method fails\n      // https://github.com/nodeca/pica/issues/190\n\n      /* eslint-disable no-unused-vars */\n      [\"catch\"](function (e) {\n        return null;\n      });\n    }\n\n    throw new Error('Pica: \".from\" should be Image, Canvas or ImageBitmap');\n  }).then(function () {\n    if (opts.canceled) return opts.cancelToken;\n\n    _this3.debug('Calculate tiles'); //\n    // Here we are with \"normalized\" source,\n    // follow to tiling\n    //\n\n\n    var regions = createRegions({\n      width: opts.width,\n      height: opts.height,\n      srcTileSize: _this3.options.tile,\n      toWidth: opts.toWidth,\n      toHeight: opts.toHeight,\n      destTileBorder: opts.__destTileBorder\n    });\n    var jobs = regions.map(function (tile) {\n      return processTile(tile);\n    });\n\n    function cleanup(stageEnv) {\n      if (stageEnv.srcImageBitmap) {\n        if (!stageEnv.isImageBitmapReused) stageEnv.srcImageBitmap.close();\n        stageEnv.srcImageBitmap = null;\n      }\n    }\n\n    _this3.debug('Process tiles');\n\n    return Promise.all(jobs).then(function () {\n      _this3.debug('Finished!');\n\n      cleanup(stageEnv);\n      return to;\n    }, function (err) {\n      cleanup(stageEnv);\n      throw err;\n    });\n  });\n};\n\nPica.prototype.__processStages = function (stages, from, to, opts) {\n  var _this4 = this;\n\n  if (opts.canceled) return opts.cancelToken;\n\n  var _stages$shift = stages.shift(),\n      _stages$shift2 = _slicedToArray(_stages$shift, 2),\n      toWidth = _stages$shift2[0],\n      toHeight = _stages$shift2[1];\n\n  var isLastStage = stages.length === 0; // Optimization for legacy filters -\n  // only use user-defined quality for the last stage,\n  // use simpler (Hamming) filter for the first stages where\n  // scale factor is large enough (more than 2-3)\n  //\n  // For advanced filters (mks2013 and custom) - skip optimization,\n  // because need to apply sharpening every time\n\n  var filter;\n  if (isLastStage || filter_info.q2f.indexOf(opts.filter) < 0) filter = opts.filter;else if (opts.filter === 'box') filter = 'box';else filter = 'hamming';\n  opts = assign({}, opts, {\n    toWidth: toWidth,\n    toHeight: toHeight,\n    filter: filter\n  });\n  var tmpCanvas;\n\n  if (!isLastStage) {\n    // create temporary canvas\n    tmpCanvas = this.options.createCanvas(toWidth, toHeight);\n  }\n\n  return this.__tileAndResize(from, isLastStage ? to : tmpCanvas, opts).then(function () {\n    if (isLastStage) return to;\n    opts.width = toWidth;\n    opts.height = toHeight;\n    return _this4.__processStages(stages, tmpCanvas, to, opts);\n  }).then(function (res) {\n    if (tmpCanvas) {\n      // Safari 12 workaround\n      // https://github.com/nodeca/pica/issues/199\n      tmpCanvas.width = tmpCanvas.height = 0;\n    }\n\n    return res;\n  });\n};\n\nPica.prototype.__resizeViaCreateImageBitmap = function (from, to, opts) {\n  var _this5 = this;\n\n  var toCtx = to.getContext('2d');\n  this.debug('Resize via createImageBitmap()');\n  return createImageBitmap(from, {\n    resizeWidth: opts.toWidth,\n    resizeHeight: opts.toHeight,\n    resizeQuality: utils.cib_quality_name(filter_info.f2q[opts.filter])\n  }).then(function (imageBitmap) {\n    if (opts.canceled) return opts.cancelToken; // if no unsharp - draw directly to output canvas\n\n    if (!opts.unsharpAmount) {\n      toCtx.drawImage(imageBitmap, 0, 0);\n      imageBitmap.close();\n      toCtx = null;\n\n      _this5.debug('Finished!');\n\n      return to;\n    }\n\n    _this5.debug('Unsharp result');\n\n    var tmpCanvas = _this5.options.createCanvas(opts.toWidth, opts.toHeight);\n\n    var tmpCtx = tmpCanvas.getContext('2d');\n    tmpCtx.drawImage(imageBitmap, 0, 0);\n    imageBitmap.close();\n    var iData = tmpCtx.getImageData(0, 0, opts.toWidth, opts.toHeight);\n\n    _this5.__mathlib.unsharp_mask(iData.data, opts.toWidth, opts.toHeight, opts.unsharpAmount, opts.unsharpRadius, opts.unsharpThreshold);\n\n    toCtx.putImageData(iData, 0, 0); // Safari 12 workaround\n    // https://github.com/nodeca/pica/issues/199\n\n    tmpCanvas.width = tmpCanvas.height = 0;\n    iData = tmpCtx = tmpCanvas = toCtx = null;\n\n    _this5.debug('Finished!');\n\n    return to;\n  });\n};\n\nPica.prototype.resize = function (from, to, options) {\n  var _this6 = this;\n\n  this.debug('Start resize...');\n  var opts = assign({}, DEFAULT_RESIZE_OPTS);\n\n  if (!isNaN(options)) {\n    opts = assign(opts, {\n      quality: options\n    });\n  } else if (options) {\n    opts = assign(opts, options);\n  }\n\n  opts.toWidth = to.width;\n  opts.toHeight = to.height;\n  opts.width = from.naturalWidth || from.width;\n  opts.height = from.naturalHeight || from.height; // Legacy `.quality` option\n\n  if (Object.prototype.hasOwnProperty.call(opts, 'quality')) {\n    if (opts.quality < 0 || opts.quality > 3) {\n      throw new Error(\"Pica: .quality should be [0..3], got \".concat(opts.quality));\n    }\n\n    opts.filter = filter_info.q2f[opts.quality];\n  } // Prevent stepper from infinite loop\n\n\n  if (to.width === 0 || to.height === 0) {\n    return Promise.reject(new Error(\"Invalid output size: \".concat(to.width, \"x\").concat(to.height)));\n  }\n\n  if (opts.unsharpRadius > 2) opts.unsharpRadius = 2;\n  opts.canceled = false;\n\n  if (opts.cancelToken) {\n    // Wrap cancelToken to avoid successive resolve & set flag\n    opts.cancelToken = opts.cancelToken.then(function (data) {\n      opts.canceled = true;\n      throw data;\n    }, function (err) {\n      opts.canceled = true;\n      throw err;\n    });\n  }\n\n  var DEST_TILE_BORDER = 3; // Max possible filter window size\n\n  opts.__destTileBorder = Math.ceil(Math.max(DEST_TILE_BORDER, 2.5 * opts.unsharpRadius | 0));\n  return this.init().then(function () {\n    if (opts.canceled) return opts.cancelToken; // if createImageBitmap supports resize, just do it and return\n\n    if (_this6.features.cib) {\n      if (filter_info.q2f.indexOf(opts.filter) >= 0) {\n        return _this6.__resizeViaCreateImageBitmap(from, to, opts);\n      }\n\n      _this6.debug('cib is enabled, but not supports provided filter, fallback to manual math');\n    }\n\n    if (!CAN_USE_CANVAS_GET_IMAGE_DATA) {\n      var err = new Error('Pica: cannot use getImageData on canvas, ' + \"make sure fingerprinting protection isn't enabled\");\n      err.code = 'ERR_GET_IMAGE_DATA';\n      throw err;\n    } //\n    // No easy way, let's resize manually via arrays\n    //\n\n\n    var stages = createStages(opts.width, opts.height, opts.toWidth, opts.toHeight, _this6.options.tile, opts.__destTileBorder);\n    return _this6.__processStages(stages, from, to, opts);\n  });\n}; // RGBA buffer resize\n//\n\n\nPica.prototype.resizeBuffer = function (options) {\n  var _this7 = this;\n\n  var opts = assign({}, DEFAULT_RESIZE_OPTS, options); // Legacy `.quality` option\n\n  if (Object.prototype.hasOwnProperty.call(opts, 'quality')) {\n    if (opts.quality < 0 || opts.quality > 3) {\n      throw new Error(\"Pica: .quality should be [0..3], got \".concat(opts.quality));\n    }\n\n    opts.filter = filter_info.q2f[opts.quality];\n  }\n\n  return this.init().then(function () {\n    return _this7.__mathlib.resizeAndUnsharp(opts);\n  });\n};\n\nPica.prototype.toBlob = function (canvas, mimeType, quality) {\n  mimeType = mimeType || 'image/png';\n  return new Promise(function (resolve) {\n    if (canvas.toBlob) {\n      canvas.toBlob(function (blob) {\n        return resolve(blob);\n      }, mimeType, quality);\n      return;\n    }\n\n    if (canvas.convertToBlob) {\n      resolve(canvas.convertToBlob({\n        type: mimeType,\n        quality: quality\n      }));\n      return;\n    } // Fallback for old browsers\n\n\n    var asString = atob(canvas.toDataURL(mimeType, quality).split(',')[1]);\n    var len = asString.length;\n    var asBuffer = new Uint8Array(len);\n\n    for (var i = 0; i < len; i++) {\n      asBuffer[i] = asString.charCodeAt(i);\n    }\n\n    resolve(new Blob([asBuffer], {\n      type: mimeType\n    }));\n  });\n};\n\nPica.prototype.debug = function () {};\n\nmodule.exports = Pica;\n\n},{\"./lib/mathlib\":1,\"./lib/mm_resize/resize_filter_info\":7,\"./lib/pool\":13,\"./lib/stepper\":14,\"./lib/tiler\":15,\"./lib/utils\":16,\"./lib/worker\":17,\"object-assign\":22,\"webworkify\":23}]},{},[])(\"/index.js\")\n});\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}